(()=>{var Rc=Object.create;var at=Object.defineProperty,Ic=Object.defineProperties,Ta=Object.getOwnPropertyDescriptor,Ec=Object.getOwnPropertyDescriptors,kc=Object.getOwnPropertyNames,Oa=Object.getOwnPropertySymbols,_c=Object.getPrototypeOf,Ca=Object.prototype.hasOwnProperty,Mc=Object.prototype.propertyIsEnumerable;var Ra=(r,e,t)=>e in r?at(r,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):r[e]=t,h=(r,e)=>{for(var t in e||(e={}))Ca.call(e,t)&&Ra(r,t,e[t]);if(Oa)for(var t of Oa(e))Mc.call(e,t)&&Ra(r,t,e[t]);return r},T=(r,e)=>Ic(r,Ec(e)),Nc=r=>at(r,"__esModule",{value:!0}),a=(r,e)=>at(r,"name",{value:e,configurable:!0});var E=(r,e)=>()=>(e||r((e={exports:{}}).exports,e),e.exports);var jc=(r,e,t)=>{if(e&&typeof e=="object"||typeof e=="function")for(let n of kc(e))!Ca.call(r,n)&&n!=="default"&&at(r,n,{get:()=>e[n],enumerable:!(t=Ta(e,n))||t.enumerable});return r},O=r=>jc(Nc(at(r!=null?Rc(_c(r)):{},"default",r&&r.__esModule&&"default"in r?{get:()=>r.default,enumerable:!0}:{value:r,enumerable:!0})),r),fe=(r,e,t,n)=>{for(var i=n>1?void 0:n?Ta(e,t):e,s=r.length-1,o;s>=0;s--)(o=r[s])&&(i=(n?o(e,t,i):o(i))||i);return n&&i&&at(e,t,i),i};var g=(r,e,t)=>new Promise((n,i)=>{var s=l=>{try{c(t.next(l))}catch(u){i(u)}},o=l=>{try{c(t.throw(l))}catch(u){i(u)}},c=l=>l.done?n(l.value):Promise.resolve(l.value).then(s,o);c((t=t.apply(r,e)).next())});var ve=E(st=>{"use strict";Object.defineProperty(st,"__esModule",{value:!0});st.caching=st.cache=void 0;function Lc(r,e,t){if(typeof t.value!="function")throw new Error("@cache can only decorate methods");let n=new WeakMap;function i(s){let o=n.get(s);if(o)return o;let c=new Map;return n.set(s,c),c}return a(i,"getCache"),Object.defineProperty(r,e,Object.assign(Object.assign({},t),{value:function(...s){let o=JSON.stringify(s),c=i(this),l=c.get(o);if(typeof l!="undefined"||c.has(o))return l;let u=t.value.call(this,...s);return c.set(o,u),u}}))}a(Lc,"cache");st.cache=Lc;function qc(r){let e=new Map;return function(...t){let n=JSON.stringify(t),i=e.get(n);if(typeof i!="undefined"||e.has(n))return i;let s=r(...t);return e.set(n,s),s}}a(qc,"caching");st.caching=qc});var le=E((hp,yr)=>{var Ia,Ea,ka,_a,Ma,Na,ja,La,qa,fr,ci,Fa,Ka,ot,Ua,$a,Ha,Ba,Ga,za,Va,Wa,mr;(function(r){var e=typeof global=="object"?global:typeof self=="object"?self:typeof this=="object"?this:{};typeof define=="function"&&undefined?define("tslib",["exports"],function(n){r(t(e,t(n)))}):typeof yr=="object"&&typeof yr.exports=="object"?r(t(e,t(yr.exports))):r(t(e));function t(n,i){return n!==e&&(typeof Object.create=="function"?Object.defineProperty(n,"__esModule",{value:!0}):n.__esModule=!0),function(s,o){return n[s]=i?i(s,o):o}}a(t,"createExporter")})(function(r){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,i){n.__proto__=i}||function(n,i){for(var s in i)Object.prototype.hasOwnProperty.call(i,s)&&(n[s]=i[s])};Ia=a(function(n,i){e(n,i);function s(){this.constructor=n}a(s,"__"),n.prototype=i===null?Object.create(i):(s.prototype=i.prototype,new s)},"__extends"),Ea=Object.assign||function(n){for(var i,s=1,o=arguments.length;s<o;s++){i=arguments[s];for(var c in i)Object.prototype.hasOwnProperty.call(i,c)&&(n[c]=i[c])}return n},ka=a(function(n,i){var s={};for(var o in n)Object.prototype.hasOwnProperty.call(n,o)&&i.indexOf(o)<0&&(s[o]=n[o]);if(n!=null&&typeof Object.getOwnPropertySymbols=="function")for(var c=0,o=Object.getOwnPropertySymbols(n);c<o.length;c++)i.indexOf(o[c])<0&&Object.prototype.propertyIsEnumerable.call(n,o[c])&&(s[o[c]]=n[o[c]]);return s},"__rest"),_a=a(function(n,i,s,o){var c=arguments.length,l=c<3?i:o===null?o=Object.getOwnPropertyDescriptor(i,s):o,u;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")l=Reflect.decorate(n,i,s,o);else for(var v=n.length-1;v>=0;v--)(u=n[v])&&(l=(c<3?u(l):c>3?u(i,s,l):u(i,s))||l);return c>3&&l&&Object.defineProperty(i,s,l),l},"__decorate"),Ma=a(function(n,i){return function(s,o){i(s,o,n)}},"__param"),Na=a(function(n,i){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(n,i)},"__metadata"),ja=a(function(n,i,s,o){function c(l){return l instanceof s?l:new s(function(u){u(l)})}return a(c,"adopt"),new(s||(s=Promise))(function(l,u){function v(V){try{b(o.next(V))}catch(je){u(je)}}a(v,"fulfilled");function D(V){try{b(o.throw(V))}catch(je){u(je)}}a(D,"rejected");function b(V){V.done?l(V.value):c(V.value).then(v,D)}a(b,"step"),b((o=o.apply(n,i||[])).next())})},"__awaiter"),La=a(function(n,i){var s={label:0,sent:function(){if(l[0]&1)throw l[1];return l[1]},trys:[],ops:[]},o,c,l,u;return u={next:v(0),throw:v(1),return:v(2)},typeof Symbol=="function"&&(u[Symbol.iterator]=function(){return this}),u;function v(b){return function(V){return D([b,V])}}function D(b){if(o)throw new TypeError("Generator is already executing.");for(;s;)try{if(o=1,c&&(l=b[0]&2?c.return:b[0]?c.throw||((l=c.return)&&l.call(c),0):c.next)&&!(l=l.call(c,b[1])).done)return l;switch(c=0,l&&(b=[b[0]&2,l.value]),b[0]){case 0:case 1:l=b;break;case 4:return s.label++,{value:b[1],done:!1};case 5:s.label++,c=b[1],b=[0];continue;case 7:b=s.ops.pop(),s.trys.pop();continue;default:if(l=s.trys,!(l=l.length>0&&l[l.length-1])&&(b[0]===6||b[0]===2)){s=0;continue}if(b[0]===3&&(!l||b[1]>l[0]&&b[1]<l[3])){s.label=b[1];break}if(b[0]===6&&s.label<l[1]){s.label=l[1],l=b;break}if(l&&s.label<l[2]){s.label=l[2],s.ops.push(b);break}l[2]&&s.ops.pop(),s.trys.pop();continue}b=i.call(n,s)}catch(V){b=[6,V],c=0}finally{o=l=0}if(b[0]&5)throw b[1];return{value:b[0]?b[1]:void 0,done:!0}}},"__generator"),qa=a(function(n,i){for(var s in n)s!=="default"&&!Object.prototype.hasOwnProperty.call(i,s)&&mr(i,n,s)},"__exportStar"),mr=Object.create?function(n,i,s,o){o===void 0&&(o=s),Object.defineProperty(n,o,{enumerable:!0,get:function(){return i[s]}})}:function(n,i,s,o){o===void 0&&(o=s),n[o]=i[s]},fr=a(function(n){var i=typeof Symbol=="function"&&Symbol.iterator,s=i&&n[i],o=0;if(s)return s.call(n);if(n&&typeof n.length=="number")return{next:function(){return n&&o>=n.length&&(n=void 0),{value:n&&n[o++],done:!n}}};throw new TypeError(i?"Object is not iterable.":"Symbol.iterator is not defined.")},"__values"),ci=a(function(n,i){var s=typeof Symbol=="function"&&n[Symbol.iterator];if(!s)return n;var o=s.call(n),c,l=[],u;try{for(;(i===void 0||i-- >0)&&!(c=o.next()).done;)l.push(c.value)}catch(v){u={error:v}}finally{try{c&&!c.done&&(s=o.return)&&s.call(o)}finally{if(u)throw u.error}}return l},"__read"),Fa=a(function(){for(var n=[],i=0;i<arguments.length;i++)n=n.concat(ci(arguments[i]));return n},"__spread"),Ka=a(function(){for(var n=0,i=0,s=arguments.length;i<s;i++)n+=arguments[i].length;for(var o=Array(n),c=0,i=0;i<s;i++)for(var l=arguments[i],u=0,v=l.length;u<v;u++,c++)o[c]=l[u];return o},"__spreadArrays"),ot=a(function(n){return this instanceof ot?(this.v=n,this):new ot(n)},"__await"),Ua=a(function(n,i,s){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var o=s.apply(n,i||[]),c,l=[];return c={},u("next"),u("throw"),u("return"),c[Symbol.asyncIterator]=function(){return this},c;function u(q){o[q]&&(c[q]=function(it){return new Promise(function(oi,Cc){l.push([q,it,oi,Cc])>1||v(q,it)})})}function v(q,it){try{D(o[q](it))}catch(oi){je(l[0][3],oi)}}function D(q){q.value instanceof ot?Promise.resolve(q.value.v).then(b,V):je(l[0][2],q)}function b(q){v("next",q)}function V(q){v("throw",q)}function je(q,it){q(it),l.shift(),l.length&&v(l[0][0],l[0][1])}},"__asyncGenerator"),$a=a(function(n){var i,s;return i={},o("next"),o("throw",function(c){throw c}),o("return"),i[Symbol.iterator]=function(){return this},i;function o(c,l){i[c]=n[c]?function(u){return(s=!s)?{value:ot(n[c](u)),done:c==="return"}:l?l(u):u}:l}},"__asyncDelegator"),Ha=a(function(n){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var i=n[Symbol.asyncIterator],s;return i?i.call(n):(n=typeof fr=="function"?fr(n):n[Symbol.iterator](),s={},o("next"),o("throw"),o("return"),s[Symbol.asyncIterator]=function(){return this},s);function o(l){s[l]=n[l]&&function(u){return new Promise(function(v,D){u=n[l](u),c(v,D,u.done,u.value)})}}function c(l,u,v,D){Promise.resolve(D).then(function(b){l({value:b,done:v})},u)}},"__asyncValues"),Ba=a(function(n,i){return Object.defineProperty?Object.defineProperty(n,"raw",{value:i}):n.raw=i,n},"__makeTemplateObject");var t=Object.create?function(n,i){Object.defineProperty(n,"default",{enumerable:!0,value:i})}:function(n,i){n.default=i};Ga=a(function(n){if(n&&n.__esModule)return n;var i={};if(n!=null)for(var s in n)s!=="default"&&Object.prototype.hasOwnProperty.call(n,s)&&mr(i,n,s);return t(i,n),i},"__importStar"),za=a(function(n){return n&&n.__esModule?n:{default:n}},"__importDefault"),Va=a(function(n,i){if(!i.has(n))throw new TypeError("attempted to get private field on non-instance");return i.get(n)},"__classPrivateFieldGet"),Wa=a(function(n,i,s){if(!i.has(n))throw new TypeError("attempted to set private field on non-instance");return i.set(n,s),s},"__classPrivateFieldSet"),r("__extends",Ia),r("__assign",Ea),r("__rest",ka),r("__decorate",_a),r("__param",Ma),r("__metadata",Na),r("__awaiter",ja),r("__generator",La),r("__exportStar",qa),r("__createBinding",mr),r("__values",fr),r("__read",ci),r("__spread",Fa),r("__spreadArrays",Ka),r("__await",ot),r("__asyncGenerator",Ua),r("__asyncDelegator",$a),r("__asyncValues",Ha),r("__makeTemplateObject",Ba),r("__importStar",Ga),r("__importDefault",za),r("__classPrivateFieldGet",Va),r("__classPrivateFieldSet",Wa)})});var qe=E(Le=>{"use strict";Object.defineProperty(Le,"__esModule",{value:!0});Le.container=Le.lazy=Le.replace=void 0;function Ja(r,e,t){return Object.defineProperty(r,e,{value:t})}a(Ja,"replace");Le.replace=Ja;function Ya(r,e,t){if(typeof t.get=="undefined")throw new Error("@lazy can only decorate getter methods");return Object.defineProperty(r,e,Object.assign(Object.assign({},t),{get(){return Ja(this,e,t.get.call(this))[e]}}))}a(Ya,"lazy");Le.lazy=Ya;function Fc(r){return Object.keys(r).reduce((e,t)=>Ya(e,t,{configurable:!0,get:()=>r[t](e)}),{})}a(Fc,"container");Le.container=Fc});var lt=E(ct=>{"use strict";Object.defineProperty(ct,"__esModule",{value:!0});ct.unique=ct.flatten=void 0;function Kc(r){return r.reduce((e,t)=>e.concat(t),[])}a(Kc,"flatten");ct.flatten=Kc;function Xa(r){return typeof r=="function"&&r.toString().includes("native code")}a(Xa,"isNativeFunction");var Uc=Xa(Set)&&new Set([1]).size===1;function $c(r){if(Xa(Array.from)&&Uc)return Array.from(new Set(r));let e=[];for(let t of r)e.indexOf(t)<0&&e.push(t);return e}a($c,"unique");ct.unique=$c});var Fe=E(_=>{"use strict";Object.defineProperty(_,"__esModule",{value:!0});_.splitByRegex=_.characters=_.removeUnneededUnicodeCharacters=_.different=_.suffix=_.prefix=_.replace=_.isNonMatch=_.isNamedMatch=_.NamedRegExp=void 0;var Hc=/\(\?<([^>]+)>/g,_t=class{constructor(e,t){this.pattern=e,this.names=t}static create(e,t){let n=[],i=Za(Hc,e,s=>(n.push(s[1]),"("));return new _t(new RegExp(i,t),n)}match(e){let t=e.match(this.pattern);return t?this.namedMatch(t):[]}namedMatch(e){return e.slice(1).map((n,i)=>({name:this.names[i],value:n}))}*exec(e){let t=new RegExp(this.pattern.source,"g");for(;;){let n=t.exec(e);if(!n)break;yield this.namedMatch(n)}}*iterate(e){let t=0,n=new RegExp(this.pattern.source,"g");for(;;){let s=n.exec(e);if(!s)break;let o=e.substring(t,s.index);o&&(yield o),yield this.namedMatch(s),t=n.lastIndex}let i=e.substring(t);i&&(yield i)}toString(){return`Pattern: ${this.pattern} Names: ${JSON.stringify(this.names)}`}toJSON(){return{pattern:this.pattern.source,names:this.names}}};a(_t,"NamedRegExp");_.NamedRegExp=_t;function Bc(r){return Array.isArray(r)}a(Bc,"isNamedMatch");_.isNamedMatch=Bc;function Gc(r){return typeof r=="string"}a(Gc,"isNonMatch");_.isNonMatch=Gc;function Za(r,e,t,n=i=>i){let i=[],s=0,o;for(;(o=r.exec(e))!=null;)i.push(n(e.substring(s,o.index))),i.push(t(o)),s=r.lastIndex;return i.push(n(e.substring(s))),i.join("")}a(Za,"replace");_.replace=Za;function li(r,e){for(let t=0;t<r.length;t++){let n=r[t],i=e[t];if(n!=i)return t}return r.length}a(li,"prefix");_.prefix=li;function Qa(r,e){return li([...r].reverse(),[...e].reverse())}a(Qa,"suffix");_.suffix=Qa;function zc(r){let e=r.map(ts),[t,n]=e.reduce(([i,s],o,c)=>{let l=c<e.length-1?e[c+1]:e[0],u=li(o,l),v=Qa(o,l);return[u<i?u:i,v<s?v:s]},[Number.MAX_VALUE,Number.MAX_VALUE]);return e.map(i=>i.slice(t,n?-n:void 0).join(""))}a(zc,"different");_.different=zc;function es(r){let e=r.charCodeAt(0);return e!=8206&&e!=8207}a(es,"removeUnneededUnicodeCharacters");_.removeUnneededUnicodeCharacters=es;function ts(r){return Vc(r).filter(es)}a(ts,"characters");_.characters=ts;function Vc(r){return typeof Symbol=="function"&&r[Symbol.iterator]?[...r]:rs(r)}a(Vc,"split");var Wc=/(?=(?:[\0-\uD7FF\uE000-\uFFFF]|[\uD800-\uDBFF][\uDC00-\uDFFF]|[\uD800-\uDBFF](?![\uDC00-\uDFFF])|(?:[^\uD800-\uDBFF]|^)[\uDC00-\uDFFF]))/;function rs(r){return r.split(Wc)}a(rs,"splitByRegex");_.splitByRegex=rs});var ui=E(N=>{"use strict";Object.defineProperty(N,"__esModule",{value:!0});N.yearOf=N.dayOf=N.monthOf=N.Month=N.weekdayOf=N.Weekday=N.defaultOptions=N.date=void 0;function Jc(r,e,t){if(e&&(e<1||e>12))throw new Error(`Invalid month ${e}`);if(t&&(t<1||t>31))throw new Error(`Invalid day ${t}`);let n=new Date(Date.UTC(r,e?e-1:0,t||1));if(r!==ss(n))throw new Error(`Invalid year ${r}`);if(e&&e!==is(n))throw new Error(`Invalid month ${e}`);if(t&&t!==as(n))throw new Error(`Invalid day ${t}`);return n}a(Jc,"date");N.date=Jc;N.defaultOptions={year:"numeric",month:"numeric",day:"numeric",weekday:"long"};var ns;(function(r){r[r.Monday=1]="Monday",r[r.Tuesday=2]="Tuesday",r[r.Wednesday=3]="Wednesday",r[r.Thursday=4]="Thursday",r[r.Friday=5]="Friday",r[r.Saturday=6]="Saturday",r[r.Sunday=7]="Sunday"})(ns=N.Weekday||(N.Weekday={}));function Yc(r){let e=r.getUTCDay();return e===0?ns.Sunday:e}a(Yc,"weekdayOf");N.weekdayOf=Yc;var Xc;(function(r){r[r.January=1]="January",r[r.February=2]="February",r[r.March=3]="March",r[r.April=4]="April",r[r.May=5]="May",r[r.June=6]="June",r[r.July=7]="July",r[r.August=8]="August",r[r.September=9]="September",r[r.October=10]="October",r[r.November=11]="November",r[r.December=12]="December"})(Xc=N.Month||(N.Month={}));function is(r){return r.getUTCMonth()+1}a(is,"monthOf");N.monthOf=is;function as(r){return r.getUTCDate()}a(as,"dayOf");N.dayOf=as;function ss(r){return r.getUTCFullYear()}a(ss,"yearOf");N.yearOf=ss});var di=E(we=>{"use strict";Object.defineProperty(we,"__esModule",{value:!0});we.sum=we.subtract=we.add=we.increment=void 0;function Zc(r){return r+1}a(Zc,"increment");we.increment=Zc;function Qc(r,e){return e===void 0?t=>r+t:r+e}a(Qc,"add");we.add=Qc;function el(r,e){return e===void 0?t=>t-r:r-e}a(el,"subtract");we.subtract=el;we.sum=(r,e)=>r+e});var Nt=E(Y=>{"use strict";Object.defineProperty(Y,"__esModule",{value:!0});Y.AsyncSequence=Y.Sequence=Y.sequence=Y.range=Y.repeat=Y.iterate=void 0;var pi=di(),os=me(),fi=z();function*gr(r,e){for(;;)yield e,e=r(e)}a(gr,"iterate");Y.iterate=gr;function*tl(r){for(;;)yield r()}a(tl,"repeat");Y.repeat=tl;function*rl(r,e,t=1){if(t===0)throw new Error("step can not be 0");if(e===void 0)yield*gr(pi.add(t),r);else{let n=Math.abs(t);e<r?yield*mi(gr(pi.subtract(n),r),os.takeWhile(i=>i>=e)):yield*mi(gr(pi.add(n),r),os.takeWhile(i=>i<=e))}}a(rl,"range");Y.range=rl;function mi(r,...e){return fi.isIterable(r)?new Mt(r,e):fi.isArrayLike(r)?new Mt(fi.iterable(r),e):new hr(r,e)}a(mi,"sequence");Y.sequence=mi;var Mt=class{constructor(e,t){this.source=e,this.transducers=t}[Symbol.iterator](){return this.transducers.reduce((e,t)=>t.sync(e),this.source)[Symbol.iterator]()}};a(Mt,"Sequence");Y.Sequence=Mt;var hr=class{constructor(e,t){this.source=e,this.transducers=t}[Symbol.asyncIterator](){return this.transducers.reduce((e,t)=>t.async_(e),this.source)[Symbol.asyncIterator]()}};a(hr,"AsyncSequence");Y.AsyncSequence=hr});var z=E(P=>{"use strict";Object.defineProperty(P,"__esModule",{value:!0});P.AsyncIteratorHandler=P.single=P.by=P.toAsyncIterable=P.array=P.isArrayLike=P.asyncIterable=P.iterable=P.toIterable=P.isPromiseLike=P.isAsyncIterable=P.isIterable=P.value=P.key=P.comparators=P.descending=P.ascending=void 0;var Ke=le(),br=Nt();function vr(r,e){return r<e?-1:r>e?1:0}a(vr,"ascending");P.ascending=vr;function nl(r,e){return r<e?1:r>e?-1:0}a(nl,"descending");P.descending=nl;function il(...r){return(e,t)=>{for(let n of r){let i=n(e,t);if(i!=0)return i}return 0}}a(il,"comparators");P.comparators=il;function al(r){return Object.assign(e=>e[r],{name:r})}a(al,"key");P.key=al;function sl(r){return e=>e[r]}a(sl,"value");P.value=sl;function yi(r){return typeof r=="object"&&Symbol.iterator in r}a(yi,"isIterable");P.isIterable=yi;function ol(r){return typeof r=="object"&&Symbol.asyncIterator in r}a(ol,"isAsyncIterable");P.isAsyncIterable=ol;function cl(r){return typeof r=="object"&&"then"in r}a(cl,"isPromiseLike");P.isPromiseLike=cl;function ll(...r){return r}a(ll,"toIterable");P.toIterable=ll;function*ul(r){for(let e=0;e<r.length;e++)yield r[e]}a(ul,"iterable");P.iterable=ul;function dl(r){return Ke.__asyncGenerator(this,arguments,a(function*(){for(let t of r)yield yield Ke.__await(t)},"asyncIterable_1"))}a(dl,"asyncIterable");P.asyncIterable=dl;function cs(r){return typeof r=="object"&&typeof r.length=="number"}a(cs,"isArrayLike");P.isArrayLike=cs;function pl(r,...e){return yi(r)||cs(r)?fl(br.sequence(r,...e)):ml(br.sequence(r,...e))}a(pl,"array");P.array=pl;function fl(r){let e=[];for(let t of r)e.push(t);return e}a(fl,"toArray");function ml(r){var e,t,n,i;return Ke.__awaiter(this,void 0,void 0,function*(){let s=[];try{for(e=Ke.__asyncValues(r);t=yield e.next(),!t.done;){let o=t.value;s.push(o)}}catch(o){n={error:o}}finally{try{t&&!t.done&&(i=e.return)&&(yield i.call(e))}finally{if(n)throw n.error}}return s})}a(ml,"toPromiseArray");function yl(r){return Ke.__asyncGenerator(this,arguments,a(function*(){yield yield Ke.__await(r)},"toAsyncIterable_1"))}a(yl,"toAsyncIterable");P.toAsyncIterable=yl;function gl(r,e=vr){return typeof r=="function"?bl(r,e):hl(r,e)}a(gl,"by");P.by=gl;function hl(r,e=vr){return(t,n)=>e(t[r],n[r])}a(hl,"byKey");function bl(r,e=vr){return(t,n)=>e(r(t),r(n))}a(bl,"byFn");function vl(r,...e){return yi(r)?wl(br.sequence(r,...e)):xl(br.sequence(r,...e))}a(vl,"single");P.single=vl;function wl(r){for(let e of r)return e;throw new Error("Expected a single value")}a(wl,"toSingle");function xl(r){var e,t,n,i;return Ke.__awaiter(this,void 0,void 0,function*(){try{for(e=Ke.__asyncValues(r);t=yield e.next(),!t.done;)return t.value}catch(s){n={error:s}}finally{try{t&&!t.done&&(i=e.return)&&(yield i.call(e))}finally{if(n)throw n.error}}throw new Error("Expected a single value")})}a(xl,"toSinglePromise");var gi=class{constructor(){this.handlers=[],this.state=[]}value(e){this.newState({value:e,done:!1})}error(e){this.newState(e)}close(){this.newState({value:void 0,done:!0})}[Symbol.asyncIterator](){return this}next(){return new Promise((e,t)=>{this.newHandler([e,t])})}newState(e){let t=this.handlers.shift();if(typeof t=="undefined")return this.state.push(e);let n=this.state.shift();if(typeof n=="undefined")return this.consume(e,t);this.consume(n,t),this.newState(e)}newHandler(e){let t=this.state.shift();if(typeof t=="undefined")return this.handlers.push(e);let n=this.handlers.shift();if(typeof n=="undefined")return this.consume(t,e);this.consume(t,n),this.newHandler(e)}consume(e,[t,n]){e instanceof Error?n(e):t(e)}};a(gi,"AsyncIteratorHandler");P.AsyncIteratorHandler=gi});var vi=E(xr=>{"use strict";Object.defineProperty(xr,"__esModule",{value:!0});xr.AVLTree=void 0;var ls=le(),wr=z(),us=qe(),ye=class{constructor(e){this.comparator=e}static empty(e=wr.ascending){return new hi(e)}static create(e,t,n=wr.ascending){let i=ye.empty(n);return new ne(n,e,t,i,i)}static of(e,t=wr.ascending){return ye.preSorted(e.sort(wr.by(0)),t,ye.empty(t))}static preSorted(e,t,n){let i=e.length;switch(i){case 0:return n;case 1:{let[[s,o]]=e;return new ne(t,s,o,n,n)}default:{let s=Math.floor(i/2),o=ye.preSorted(e.slice(0,s),t,n),c=ye.preSorted(e.slice(s+1),t,n),[l,u]=e[s];return new ne(t,l,u,o,c)}}}};a(ye,"AVLTree");xr.AVLTree=ye;var hi=class extends ye{constructor(e){super(e);this.isEmpty=!0,this.height=0,this.balance=0}insert(e,t){return new ne(this.comparator,e,t,this,this)}contains(e){return!1}lookup(e){}delete(e){return{tree:this}}first(){}last(){}removeFirst(){return{tree:this}}removeLast(){return{tree:this}}toString(){return""}*keys(){}*values(){}*entries(){return[]}};a(hi,"Empty");var ne=class extends ye{constructor(e,t,n,i,s){super(e);this.key=t,this.value=n,this.left=i,this.right=s,this.isEmpty=!1}insert(e,t){let n=this.comparator(e,this.key);return n===0?new ne(this.comparator,e,t,this.left,this.right):n<0?this.replaceLeft(this.left.insert(e,t)):this.replaceRight(this.right.insert(e,t))}contains(e){let t=this.comparator(e,this.key);return t===0?!0:t<0?this.left.contains(e):this.right.contains(e)}lookup(e){let t=this.comparator(e,this.key);return t===0?this.value:t<0?this.left.lookup(e):this.right.lookup(e)}delete(e){let t=this.comparator(e,this.key);if(t===0){if(this.left.isEmpty)return{tree:this.right,key:this.key,value:this.value};if(this.right.isEmpty)return{tree:this.left,key:this.key,value:this.value};let{tree:o,key:c,value:l}=this.left.removeLast();return{tree:bi(new ne(this.comparator,c,l,o,this.right)),key:this.key,value:this.value}}if(t<0){let{tree:o,key:c,value:l}=this.left.delete(e);return{tree:this.replaceLeft(o),key:c,value:l}}let{tree:n,key:i,value:s}=this.right.delete(e);return{tree:this.replaceRight(n),key:i,value:s}}first(){return this.left.isEmpty?this.value:this.left.first()}last(){return this.right.isEmpty?this.value:this.right.last()}removeFirst(){if(this.left.isEmpty)return{tree:this.right,key:this.key,value:this.value};let{tree:e,key:t,value:n}=this.left.removeFirst();return{tree:this.replaceLeft(e),key:t,value:n}}removeLast(){if(this.right.isEmpty)return{tree:this.left,key:this.key,value:this.value};let{tree:e,key:t,value:n}=this.right.removeLast();return{tree:this.replaceRight(e),key:t,value:n}}replaceLeft(e){return bi(new ne(this.comparator,this.key,this.value,e,this.right))}replaceRight(e){return bi(new ne(this.comparator,this.key,this.value,this.left,e))}toString(){return`(${this.left} ${this.key}=${this.value} ${this.right})`}get balance(){return this.left.height-this.right.height}get height(){return Math.max(this.left.height,this.right.height)+1}*keys(){yield*this.left.keys(),yield this.key,yield*this.right.keys()}*values(){yield*this.left.values(),yield this.value,yield*this.right.values()}*entries(){yield*this.left.entries(),yield[this.key,this.value],yield*this.right.entries()}};a(ne,"Node");ls.__decorate([us.lazy],ne.prototype,"balance",null);ls.__decorate([us.lazy],ne.prototype,"height",null);function bi(r){let e=r.balance;return e==-2?Pl(r):e==2?Dl(r):r}a(bi,"balance");function Dl(r){let e=r.left.balance;return e==-1?Sl(r):e==1?ds(r):r}a(Dl,"balanceLeft");function Pl(r){let e=r.right.balance;return e==1?Al(r):e==-1?ps(r):r}a(Pl,"balanceRight");function ds(r){return ms(r)}a(ds,"balanceLeftLeft");function Sl(r){let e=fs(r.left);return ds(r.replaceLeft(e))}a(Sl,"balanceLeftRight");function ps(r){return fs(r)}a(ps,"balanceRightRight");function Al(r){let e=ms(r.right);return ps(r.replaceRight(e))}a(Al,"balanceRightLeft");function fs(r){let e=r.right,t=e.left,n=r.replaceRight(t);return e.replaceLeft(n)}a(fs,"rotateLeft");function ms(r){let e=r.left,t=e.right,n=r.replaceLeft(t);return e.replaceRight(n)}a(ms,"rotateRight")});var me=E(p=>{"use strict";Object.defineProperty(p,"__esModule",{value:!0});p.WindowedTransducer=p.windowed=p.unique=p.UniqueTransducer=p.dedupe=p.DedupTransducer=p.sort=p.SortTransducer=p.takeWhile=p.TakeWhileTransducer=p.dropWhile=p.DropWhileTransducer=p.drop=p.DropTransducer=p.take=p.TakeTransducer=p.reduce=p.scan=p.ScanTransducer=p.decompose=p.compose=p.CompositeTransducer=p.find=p.reject=p.filter=p.FilterTransducer=p.flatMap=p.FlatMapTransducer=p.zipWithIndex=p.zip=p.ZipTransducer=p.map=p.MapTransducer=p.last=p.LastTransducer=p.first=p.FirstTransducer=p.transducer=p.identity=p.IdentityTransducer=void 0;var d=le(),Ve=z(),ys=vi(),Tl=Nt(),Dr=class{async_(e){return e}sync(e){return e}};a(Dr,"IdentityTransducer");p.IdentityTransducer=Dr;function gs(){return new Dr}a(gs,"identity");p.identity=gs;p.transducer=gs;var Pr=class{async_(e){return d.__asyncGenerator(this,arguments,a(function*(){var n,i;try{for(var s=d.__asyncValues(e),o;o=yield d.__await(s.next()),!o.done;){let c=o.value;return yield d.__await(yield yield d.__await(c))}}catch(c){n={error:c}}finally{try{o&&!o.done&&(i=s.return)&&(yield d.__await(i.call(s)))}finally{if(n)throw n.error}}},"async_1"))}*sync(e){for(let t of e)return yield t}};a(Pr,"FirstTransducer");p.FirstTransducer=Pr;function hs(){return new Pr}a(hs,"first");p.first=hs;var Sr=class{async_(e){return d.__asyncGenerator(this,arguments,a(function*(){var n,i;let s;try{for(var o=d.__asyncValues(e),c;c=yield d.__await(o.next()),!c.done;)s=c.value}catch(l){n={error:l}}finally{try{c&&!c.done&&(i=o.return)&&(yield d.__await(i.call(o)))}finally{if(n)throw n.error}}s!==void 0&&(yield yield d.__await(s))},"async_2"))}*sync(e){let t;for(t of e);t!==void 0&&(yield t)}};a(Sr,"LastTransducer");p.LastTransducer=Sr;function bs(){return new Sr}a(bs,"last");p.last=bs;var Ar=class{constructor(e){this.mapper=e}async_(e){return d.__asyncGenerator(this,arguments,a(function*(){var n,i;try{for(var s=d.__asyncValues(e),o;o=yield d.__await(s.next()),!o.done;){let c=o.value;yield yield d.__await(this.mapper(c))}}catch(c){n={error:c}}finally{try{o&&!o.done&&(i=s.return)&&(yield d.__await(i.call(s)))}finally{if(n)throw n.error}}},"async_3"))}*sync(e){for(let t of e)yield this.mapper(t)}};a(Ar,"MapTransducer");p.MapTransducer=Ar;function Ol(r){return new Ar(r)}a(Ol,"map");p.map=Ol;var jt=class{constructor(e){this.other=e}async_(e){return d.__asyncGenerator(this,arguments,a(function*(){if(!Ve.isAsyncIterable(this.other))throw new Error("Unsupported operation exception");let n=e[Symbol.asyncIterator](),i=this.other[Symbol.asyncIterator]();for(;;){let[s,o]=yield d.__await(Promise.all([n.next(),i.next()]));if(s.done||o.done)return yield d.__await(void 0);yield yield d.__await([s.value,o.value])}},"async_4"))}*sync(e){if(!Ve.isIterable(this.other))throw new Error("Unsupported operation exception");let t=e[Symbol.iterator](),n=this.other[Symbol.iterator]();for(;;){let i=t.next(),s=n.next();if(i.done||s.done)return;yield[i.value,s.value]}}};a(jt,"ZipTransducer");p.ZipTransducer=jt;function Cl(r){return new jt(r)}a(Cl,"zip");p.zip=Cl;function Rl(){return new jt(Tl.range(0))}a(Rl,"zipWithIndex");p.zipWithIndex=Rl;var Tr=class{constructor(e){this.mapper=e}async_(e){return d.__asyncGenerator(this,arguments,a(function*(){var n,i;try{for(var s=d.__asyncValues(e),o;o=yield d.__await(s.next()),!o.done;){let c=o.value;yield d.__await(yield*d.__asyncDelegator(d.__asyncValues(this.mapper(c))))}}catch(c){n={error:c}}finally{try{o&&!o.done&&(i=s.return)&&(yield d.__await(i.call(s)))}finally{if(n)throw n.error}}},"async_5"))}*sync(e){for(let t of e)yield*this.mapper(t)}};a(Tr,"FlatMapTransducer");p.FlatMapTransducer=Tr;function Il(r){return new Tr(r)}a(Il,"flatMap");p.flatMap=Il;var Lt=class{constructor(e){this.predicate=e}async_(e){return d.__asyncGenerator(this,arguments,a(function*(){var n,i;try{for(var s=d.__asyncValues(e),o;o=yield d.__await(s.next()),!o.done;){let c=o.value;this.predicate(c)&&(yield yield d.__await(c))}}catch(c){n={error:c}}finally{try{o&&!o.done&&(i=s.return)&&(yield d.__await(i.call(s)))}finally{if(n)throw n.error}}},"async_6"))}*sync(e){for(let t of e)this.predicate(t)&&(yield t)}};a(Lt,"FilterTransducer");p.FilterTransducer=Lt;function vs(r){return new Lt(r)}a(vs,"filter");p.filter=vs;function El(r){return new Lt(e=>!r(e))}a(El,"reject");p.reject=El;function kl(r){return wi(vs(r),hs())}a(kl,"find");p.find=kl;var qt=class{constructor(e,t){this.a=e,this.b=t}async_(e){return this.b.async_(this.a.async_(e))}sync(e){return this.b.sync(this.a.sync(e))}};a(qt,"CompositeTransducer");p.CompositeTransducer=qt;function wi(r,e){return new qt(r,e)}a(wi,"compose");p.compose=wi;function*xi(r){r instanceof qt?(yield*xi(r.a),yield*xi(r.b)):yield r}a(xi,"decompose");p.decompose=xi;var Or=class{constructor(e,t){this.reducer=e,this.seed=t}async_(e){return d.__asyncGenerator(this,arguments,a(function*(){var n,i;let s=this.seed;yield yield d.__await(s);try{for(var o=d.__asyncValues(e),c;c=yield d.__await(o.next()),!c.done;){let l=c.value;yield yield d.__await(s=this.reducer(s,l))}}catch(l){n={error:l}}finally{try{c&&!c.done&&(i=o.return)&&(yield d.__await(i.call(o)))}finally{if(n)throw n.error}}},"async_7"))}*sync(e){let t=this.seed;yield t;for(let n of e)yield t=this.reducer(t,n)}};a(Or,"ScanTransducer");p.ScanTransducer=Or;function ws(r,e){return new Or(r,e)}a(ws,"scan");p.scan=ws;function _l(r,e){return wi(ws(r,e),bs())}a(_l,"reduce");p.reduce=_l;var Cr=class{constructor(e){if(this.count=e,typeof e=="undefined")throw new Error("Count can not be undefined")}async_(e){return d.__asyncGenerator(this,arguments,a(function*(){var n,i;if(this.count<1)return yield d.__await(void 0);try{for(var s=d.__asyncValues(e),o;o=yield d.__await(s.next()),!o.done;){let c=o.value;if(yield yield d.__await(c),--this.count<1)return yield d.__await(void 0)}}catch(c){n={error:c}}finally{try{o&&!o.done&&(i=s.return)&&(yield d.__await(i.call(s)))}finally{if(n)throw n.error}}},"async_8"))}*sync(e){if(!(this.count<1)){for(let t of e)if(yield t,--this.count<1)return}}};a(Cr,"TakeTransducer");p.TakeTransducer=Cr;function Ml(r){return new Cr(r)}a(Ml,"take");p.take=Ml;var Rr=class{constructor(e){if(this.count=e,typeof e=="undefined")throw new Error("Count can not be undefined")}async_(e){return d.__asyncGenerator(this,arguments,a(function*(){var n,i;try{for(var s=d.__asyncValues(e),o;o=yield d.__await(s.next()),!o.done;){let c=o.value;--this.count<0&&(yield yield d.__await(c))}}catch(c){n={error:c}}finally{try{o&&!o.done&&(i=s.return)&&(yield d.__await(i.call(s)))}finally{if(n)throw n.error}}},"async_9"))}*sync(e){for(let t of e)--this.count<0&&(yield t)}};a(Rr,"DropTransducer");p.DropTransducer=Rr;function Nl(r){return new Rr(r)}a(Nl,"drop");p.drop=Nl;var Ir=class{constructor(e){this.predicate=e}async_(e){return d.__asyncGenerator(this,arguments,a(function*(){var n,i;let s=!0;try{for(var o=d.__asyncValues(e),c;c=yield d.__await(o.next()),!c.done;){let l=c.value;s&&(s=this.predicate(l)),s||(yield yield d.__await(l))}}catch(l){n={error:l}}finally{try{c&&!c.done&&(i=o.return)&&(yield d.__await(i.call(o)))}finally{if(n)throw n.error}}},"async_10"))}*sync(e){let t=!0;for(let n of e)t&&(t=this.predicate(n)),t||(yield n)}};a(Ir,"DropWhileTransducer");p.DropWhileTransducer=Ir;function jl(r){return new Ir(r)}a(jl,"dropWhile");p.dropWhile=jl;var Er=class{constructor(e){this.predicate=e}async_(e){return d.__asyncGenerator(this,arguments,a(function*(){var n,i;try{for(var s=d.__asyncValues(e),o;o=yield d.__await(s.next()),!o.done;){let c=o.value;if(this.predicate(c))yield yield d.__await(c);else return yield d.__await(void 0)}}catch(c){n={error:c}}finally{try{o&&!o.done&&(i=s.return)&&(yield d.__await(i.call(s)))}finally{if(n)throw n.error}}},"async_11"))}*sync(e){for(let t of e)if(this.predicate(t))yield t;else return}};a(Er,"TakeWhileTransducer");p.TakeWhileTransducer=Er;function Ll(r){return new Er(r)}a(Ll,"takeWhile");p.takeWhile=Ll;var kr=class{constructor(e){this.comparator=e}async_(e){return d.__asyncGenerator(this,arguments,a(function*(){let n=yield d.__await(Ve.array(e));n.sort(this.comparator),yield d.__await(yield*d.__asyncDelegator(d.__asyncValues(n)))},"async_12"))}*sync(e){let t=Ve.array(e);t.sort(this.comparator),yield*t}};a(kr,"SortTransducer");p.SortTransducer=kr;function ql(r=Ve.ascending){return new kr(r)}a(ql,"sort");p.sort=ql;var _r=class{constructor(e){this.comparator=e}async_(e){return d.__asyncGenerator(this,arguments,a(function*(){var n,i;let s;try{for(var o=d.__asyncValues(e),c;c=yield d.__await(o.next()),!c.done;){let l=c.value;typeof s=="undefined"?yield yield d.__await(l):this.comparator(l,s)!==0&&(yield yield d.__await(l)),s=l}}catch(l){n={error:l}}finally{try{c&&!c.done&&(i=o.return)&&(yield d.__await(i.call(o)))}finally{if(n)throw n.error}}},"async_13"))}*sync(e){let t;for(let n of e)typeof t=="undefined"?yield n:this.comparator(n,t)!==0&&(yield n),t=n}};a(_r,"DedupTransducer");p.DedupTransducer=_r;function Fl(r=Ve.ascending){return new _r(r)}a(Fl,"dedupe");p.dedupe=Fl;var Mr=class{constructor(e){this.comparator=e}async_(e){return d.__asyncGenerator(this,arguments,a(function*(){var n,i;let s=ys.AVLTree.empty(this.comparator);try{for(var o=d.__asyncValues(e),c;c=yield d.__await(o.next()),!c.done;){let l=c.value;s.contains(l)||(s=s.insert(l,void 0),yield yield d.__await(l))}}catch(l){n={error:l}}finally{try{c&&!c.done&&(i=o.return)&&(yield d.__await(i.call(o)))}finally{if(n)throw n.error}}},"async_14"))}*sync(e){let t=ys.AVLTree.empty(this.comparator);for(let n of e)t.contains(n)||(t=t.insert(n,void 0),yield n)}};a(Mr,"UniqueTransducer");p.UniqueTransducer=Mr;function Kl(r=Ve.ascending){return new Mr(r)}a(Kl,"unique");p.unique=Kl;function Ul(r,e=1,t=!1){return new Nr(r,e,t)}a(Ul,"windowed");p.windowed=Ul;var Nr=class{constructor(e,t,n){this.size=e,this.step=t,this.remainder=n}async_(e){return d.__asyncGenerator(this,arguments,a(function*(){var n,i;let s=[],o=0;try{for(var c=d.__asyncValues(e),l;l=yield d.__await(c.next()),!l.done;){let u=l.value;if(o>0){o--;continue}s.push(u),s.length===this.size&&(yield yield d.__await([...s]),s=s.slice(this.step),this.step>this.size&&(o=this.step-this.size))}}catch(u){n={error:u}}finally{try{l&&!l.done&&(i=c.return)&&(yield d.__await(i.call(c)))}finally{if(n)throw n.error}}this.remainder&&(yield yield d.__await([...s]))},"async_15"))}*sync(e){let t=[],n=0;for(let i of e){if(n>0){n--;continue}t.push(i),t.length===this.size&&(yield[...t],t=t.slice(this.step),this.step>this.size&&(n=this.step-this.size))}this.remainder&&(yield[...t])}};a(Nr,"WindowedTransducer");p.WindowedTransducer=Nr});var Ds=E(W=>{"use strict";Object.defineProperty(W,"__esModule",{value:!0});W.Row=W.PrefixTree=W.DEFAULT_COMPARATOR=W.pair=W.Trie=W.TrieFactory=void 0;var ut=le(),dt=qe(),$l=Fe(),Ft=z(),Hl=vi(),xe=me(),pt=Nt(),We=class{constructor(e=Ft.ascending){this.comparator=e}get avlTree(){return Hl.AVLTree.empty(this.comparator)}get empty(){return new Ue(this,void 0,this.avlTree)}create(e,t=this.avlTree){return new Ue(this,e,t)}construct(e,t){if(e.length===0)return this.create(t);let[n,...i]=e;return this.create(void 0,this.avlTree.insert(n,this.construct(i,t)))}};a(We,"TrieFactory");ut.__decorate([dt.lazy],We.prototype,"avlTree",null);ut.__decorate([dt.lazy],We.prototype,"empty",null);W.TrieFactory=We;var Ue=class{constructor(e=new We,t,n=e.avlTree){this.factory=e,this.value=t,this.children=n}contains(e){return!!this.lookup(e)}get isEmpty(){return!this.value&&this.children.isEmpty}lookup(e){if(e.length==0)return this.value;let[t,...n]=e,i=this.children.lookup(t);return i&&i.lookup(n)}match(e){if(e.length==0)return Ft.single(this.children.values(),xe.reduce((s,o)=>s.concat(o.match(e)),this.value?[this.value]:[]));let[t,...n]=e,i=this.children.lookup(t);return i?i.match(n):[]}insert(e,t){if(e.length===0)return this.factory.create(t,this.children);let[n,...i]=e,s=this.children.lookup(n);return s?s=s.insert(i,t):s=this.factory.construct(i,t),this.factory.create(this.value,this.children.insert(n,s))}delete(e){return this.insert(e,void 0)}entries(){function*e(n,[i,s]){n=[...n,i],s.value&&(yield Di(n,s.value)),yield*t(s,n)}a(e,"recurse");function t(n,i){return pt.sequence(n.children.entries(),xe.flatMap(s=>e(i,s)))}return a(t,"recurseChildren"),t(this,[])}keys(){return pt.sequence(this.entries(),xe.map(([e])=>e))}values(){return pt.sequence(this.entries(),xe.map(([,e])=>e))}get height(){return Ft.single(this.children.values(),xe.reduce((e,t)=>Math.max(e,t.height+1),0))}toString(){return(this.value?`(${this.value})`:"")+this.children}};a(Ue,"Trie");ut.__decorate([dt.lazy],Ue.prototype,"isEmpty",null);ut.__decorate([dt.lazy],Ue.prototype,"height",null);W.Trie=Ue;function Di(r,e){return[r,e]}a(Di,"pair");W.pair=Di;var Bl=new Intl.Collator(void 0,{usage:"sort",sensitivity:"base"}).compare;W.DEFAULT_COMPARATOR=Bl;var $e=class{constructor(e=$l.characters,t=W.DEFAULT_COMPARATOR,n=new Ue(new We(t))){this.converter=e,this.comparator=t,this.trie=n}contains(e){return!!this.lookup(e)}get isEmpty(){return this.trie.isEmpty}match(e){return this.trie.match(this.converter(e))}lookup(e){return this.trie.lookup(this.converter(e))}insert(e,t=e){return new $e(this.converter,this.comparator,this.trie.insert(this.converter(e),t))}delete(e){return new $e(this.converter,this.comparator,this.trie.insert(this.converter(e),void 0))}entries(){return pt.sequence(this.trie.entries(),xe.map(([e,t])=>Di(e.join(""),t)))}keys(){return pt.sequence(this.entries(),xe.map(([e])=>e))}values(){return pt.sequence(this.entries(),xe.map(([,e])=>e))}get height(){return this.trie.height}search(e,t){let n=Je.create(this.converter(e),this.comparator);return Ft.single(this.trie.children.entries(),xe.reduce((i,[s,o])=>i.concat(xs(o,s,n,t)),[]))}};a($e,"PrefixTree");ut.__decorate([dt.lazy],$e.prototype,"isEmpty",null);ut.__decorate([dt.lazy],$e.prototype,"height",null);W.PrefixTree=$e;function xs(r,e,t,n){let i=t.next(e),s=[];return i.distance<=n&&r.value&&s.push({value:r.value,distance:i.distance}),i.minimal<=n?Ft.single(r.children.entries(),xe.reduce((o,[c,l])=>o.concat(xs(l,c,i,n)),s)):s}a(xs,"recurse");var Je=class{constructor(e,t,n){this.keys=e,this.values=t,this.comparator=n}static create(e,t){let n=[];for(let i=0;i<=e.length;i++)n[i]=i;return new Je(e,n,t)}next(e){let t=this.keys.reduce((n,i,s)=>(n[s+1]=this.comparator(i,e)===0?this.values[s]:1+Math.min(n[s],this.values[s],this.values[s+1]),n),[this.values[0]+1]);return new Je(this.keys,t,this.comparator)}get distance(){return this.values[this.keys.length]}get minimal(){return Math.min(...this.values)}};a(Je,"Row");W.Row=Je});var Ps=E(jr=>{"use strict";Object.defineProperty(jr,"__esModule",{value:!0});jr.PreferredCurrencies=void 0;var j=class{static dollarSymbol(e){return e&&j.dollarCountries[e]||"USD"}static poundSymbol(e){return e&&j.poundCountries[e]||"GBP"}static yenSymbol(e){return e&&j.yenCountries[e]||"JPY"}static kroneSymbol(e){return e&&j.kroneCountries[e]||"DKK"}static rupeeSymbol(e){return e&&j.rupeeCountries[e]||"INR"}static for(e){return[j.dollarSymbol(e),j.poundSymbol(e),j.yenSymbol(e),j.kroneSymbol(e),j.rupeeSymbol(e)]}};a(j,"PreferredCurrencies");jr.PreferredCurrencies=j;j.dollarCountries={AG:"XCD",AR:"ARS",AU:"AUD",BS:"BSD",BB:"BBD",BZ:"BZD",BM:"BMD",BN:"BND",CA:"CAD",CO:"COP",CL:"CLP",CU:"CUP",DM:"XCD",DO:"DOP",EC:"USD",FM:"USD",KY:"KYD",FJ:"FJD",GD:"XCD",GY:"GYD",HK:"HKD",JM:"JMD",KI:"AUD",KN:"XCD",LC:"XCD",LR:"LRD",MH:"USD",MX:"MXN",NA:"NAD",NZ:"NZD",SG:"SGD",SB:"SBD",SR:"SRD",SV:"USD",TL:"USD",TW:"TWD",TT:"TTD",TV:"AUD",US:"USD",UY:"UYU",VC:"XCD",ZW:"USD"};j.poundCountries={EG:"EGP",FK:"FKP",GB:"GBP",GI:"GIP",GG:"GBP",IM:"GBP",JE:"GBP",LB:"LBP",SH:"SHP",SS:"SSP",SD:"SDG",SY:"SYP"};j.yenCountries={CN:"CNY",JP:"JPY"};j.kroneCountries={DK:"DKK",FO:"DKK",GL:"DKK",IS:"ISK",NO:"NOK",SE:"SEK"};j.rupeeCountries={IN:"INR",ID:"IDR",MU:"MUR",NP:"NPR",PK:"PKR",LK:"LKR"}});var Ye=E(ft=>{"use strict";Object.defineProperty(ft,"__esModule",{value:!0});ft.get=ft.identity=void 0;function Gl(){return r=>r}a(Gl,"identity");ft.identity=Gl;function zl(r,e=void 0){try{let t=r();return typeof t=="undefined"?e:t}catch(t){return e}}a(zl,"get");ft.get=zl});var Ce=E(f=>{"use strict";Object.defineProperty(f,"__esModule",{value:!0});f.numberOf=f.inferDecimalSeparator=f.numberParser=f.NumberParser=f.decimalSeparator=f.isDecimalSeparator=f.separatorsOf=f.mapIgnoreError=f.numberPattern=f.Spaces=f.digits=f.numberFormatter=f.Numerals=f.atBoundaryOnly=f.cleanValue=f.extraDelimiters=f.boundaryDelimiters=f.CachingParser=f.all=f.AllParser=f.parsers=f.or=f.OrParser=f.infer=f.prefer=f.uniqueMatch=f.DatumLookup=f.FailParser=f.IdentityParser=f.mappingParser=f.MappingParser=f.preProcess=f.PreProcessor=f.namedRegexParser=f.NamedRegexParser=void 0;var Ss=le(),mt=Fe(),As=Ds(),Xe=lt(),Kt=z(),Ut=me(),yt=ve(),Vl=Ps(),Ts=Ye(),Lr=class{constructor(e){this.regex=e}parse(e){let t=this.regex.match(e);if(t.length===0)throw new Error(`Generated regex ${this.regex.pattern} did not match "${e}" `);return t}parseAll(e){return Kt.array(this.regex.exec(e))}};a(Lr,"NamedRegexParser");f.NamedRegexParser=Lr;function Wl(r){return new Lr(r)}a(Wl,"namedRegexParser");f.namedRegexParser=Wl;var qr=class{constructor(e,t){this.delegate=e,this.mapper=t}parse(e){return this.delegate.parse(this.mapper(e))}parseAll(e){return this.delegate.parseAll(this.mapper(e))}};a(qr,"PreProcessor");f.PreProcessor=qr;function Jl(r,e){return new qr(r,e)}a(Jl,"preProcess");f.preProcess=Jl;var Fr=class{constructor(e,t){this.parser=e,this.mapper=t}parse(e){return this.mapper(this.parser.parse(e))}parseAll(e){return e?Kt.array(this.parser.parseAll(e),Ut.flatMap(t=>{try{return[this.mapper(t)]}catch(n){return[]}})):[]}};a(Fr,"MappingParser");f.MappingParser=Fr;function Yl(r,e){return new Fr(r,e)}a(Yl,"mappingParser");f.mappingParser=Yl;var Pi=class{parse(e){return e}parseAll(e){return[e]}};a(Pi,"IdentityParser");f.IdentityParser=Pi;var Si=class{parse(e){throw new Error}parseAll(e){return[]}};a(Si,"FailParser");f.FailParser=Si;var Kr=class{constructor(e,t=As.DEFAULT_COMPARATOR){this.data=e,this.prefixTree=this.data.reduce((n,i)=>{let s=n.lookup(i.name)||[];return s.push(i),n.insert(i.name,s)},new As.PrefixTree(void 0,t))}parse(e,t=Os){let n=t(this.prefixTree,e);if(typeof n=="undefined")throw new Error(`${this.constructor.name} - Unable to parse: ${e}`);return n}get pattern(){return`[${this.characters.join("")}]{1,${this.max}}`}get max(){return this.data.reduce((e,t)=>{let n=mt.characters(t.name).length;return Math.max(e,n)},Number.MIN_VALUE)}get characters(){return Xe.unique(Xe.flatten(this.data.map(e=>e.name).map(mt.characters))).sort()}};a(Kr,"DatumLookup");f.DatumLookup=Kr;function Os(r,e){let t=Xe.flatten(r.match(e)),n=Xe.unique(t.map(i=>i.value));if(n.length==1)return n[0]}a(Os,"uniqueMatch");f.uniqueMatch=Os;function Cs(...r){if(r.filter(Boolean).length!==0)return(e,t)=>{let n=e.lookup(t)||[],i=Xe.unique(n.map(o=>o.value));if(i.length===0)return;if(i.length===1)return i[0];let[s]=i.filter(o=>r.indexOf(o)!==-1);return s}}a(Cs,"prefer");f.prefer=Cs;function Xl(r){return r?r.split(/[-_]/).filter(Boolean):[]}a(Xl,"localeParts");function Zl(r){let[,e]=Xl(r);return Cs(...Vl.PreferredCurrencies.for(e))}a(Zl,"infer");f.infer=Zl;var Ur=class{constructor(e){this.parsers=e}parse(e){for(let t of this.parsers)try{let n=t.parse(e);if(n)return n}catch(n){}throw new Error(`Unable to parse value: ${e}`)}parseAll(e){for(let t of this.parsers){let n=t.parseAll(e);if(n.length>0)return n}return[]}};a(Ur,"OrParser");f.OrParser=Ur;function Rs(...r){return new Ur(r)}a(Rs,"or");f.or=Rs;function Ql(...r){return Rs(...r)}a(Ql,"parsers");f.parsers=Ql;var $r=class{constructor(e){this.parsers=e}parse(e){throw new Error("Not supported, please call AllParser.parseAll")}parseAll(e){return Xe.flatten(this.parsers.map(t=>t.parseAll(e)))}};a($r,"AllParser");f.AllParser=$r;function eu(...r){return new $r(r)}a(eu,"all");f.all=eu;var $t=class{constructor(e){this.parser=e}parse(e){return this.parser.parse(e)}parseAll(e){return this.parser.parseAll(e)}};a($t,"CachingParser");Ss.__decorate([yt.cache],$t.prototype,"parse",null);Ss.__decorate([yt.cache],$t.prototype,"parseAll",null);f.CachingParser=$t;f.boundaryDelimiters=",.";f.extraDelimiters=" -/";var tu=new RegExp(`[${f.boundaryDelimiters}]$`);function ru(r){return r.replace(tu,"")}a(ru,"cleanValue");f.cleanValue=ru;function nu(r){return`(?:^|\\s)${r}(?=[\\s${f.boundaryDelimiters}]|$)`}a(nu,"atBoundaryOnly");f.atBoundaryOnly=nu;var ue=class extends Kr{constructor(e,t){super(e);this.locale=t}static get(e,t=[]){return ue.cache[e]=ue.cache[e]||ue.create(e,t)}static create(e,t=[]){return new ue([...ue.generateData(e),...t],e)}static generateData(e){let t=f.numberFormatter(e).format(1234567890).replace(/[,. '٬٫]/g,"");return Kt.array(mt.characters(t),Ut.zip([1,2,3,4,5,6,7,8,9,0]),Ut.map(([n,i])=>({name:n,value:i})))}parse(e){let t=Oi(e);return isNaN(t)?super.parse(e):t}format(e){return f.numberFormatter(this.locale).format(e)}};a(ue,"Numerals");f.Numerals=ue;ue.cache={};f.numberFormatter=yt.caching(r=>new Intl.NumberFormat(r,{useGrouping:!1}));f.digits=yt.caching(r=>{let e=ue.get(r).characters.join("");return e==="0123456789"?"\\d":`\\d${e}`});var de=class{static handle(e){return de.codes.indexOf(e)!=-1?de.spaces:e}};a(de,"Spaces");f.Spaces=de;de.codes=[32,160,8239].map(r=>String.fromCharCode(r));de.spaces=de.codes.join("");de.pattern=new RegExp(`[${de.spaces}]`,"g");var Is=`\u066C\u066B,.'\u2019\u2018${de.spaces}`;f.numberPattern=yt.caching(r=>{let e=f.digits(r);return`-?(?:[${e}]+[${Is}])*[${e}]+`});function Es(r){return Ut.flatMap(e=>{try{return[r(e)]}catch(t){return[]}})}a(Es,"mapIgnoreError");f.mapIgnoreError=Es;var iu=mt.NamedRegExp.create(`(?<separator>[${Is}])`);function ks(r){return Kt.array(iu.exec(r),Ut.map(([e])=>e.value))}a(ks,"separatorsOf");f.separatorsOf=ks;function Ai(r){return r&&typeof r=="string"&&r==="."||r===","||r==="\u066B"}a(Ai,"isDecimalSeparator");f.isDecimalSeparator=Ai;function _s(r){if(Ai(r))return r;throw new Error(`Invalid decimal separator${r}`)}a(_s,"decimalSeparator");f.decimalSeparator=_s;var Hr=class{constructor(e,t){this.decimalSeparator=e,this.locale=t,this.strictNumberPattern=new RegExp(`^${f.numberPattern(t)}$`),this.globalNumberPattern=mt.NamedRegExp.create(`(?<number>${f.numberPattern(t)})`,"g")}parse(e){if(!this.strictNumberPattern.test(e))throw new Error(`Unable to parse '${e}'`);return this.parseSingle(e)}parseAll(e){return Kt.array(this.globalNumberPattern.exec(e),Es(([t])=>this.parseSingle(t.value.trim())))}parseSingle(e,t=this.decimalSeparator(e)){let n=ks(e);if(n.length===0)return this.numberOf(e,t);let s=n[n.length-1]===t?n.slice(0,n.length-1):n;if(s.indexOf(t)!==-1)throw new Error(`Unable to parse '${e}'`);if(Xe.unique(s).length>1)throw new Error(`Unable to parse '${e}'`);return this.numberOf(e,t)}convert(e,t){let n=ue.get(this.locale);return mt.characters(e).map(i=>{if(i===t)return".";if(i==="-")return"-";let s=Ts.get(()=>n.parse(i));return isNaN(s)?"":s.toString()}).join("")}numberOf(e,t){let n=this.convert(e,t),i=Oi(n);if(isNaN(i))throw new Error(`Unable to parse '${e}'`);return i}};a(Hr,"NumberParser");f.NumberParser=Hr;function Ti(r,e="en"){return r?Ai(r)?new Hr(t=>r,e):Ti(f.inferDecimalSeparator(r),r):Ti(e)}a(Ti,"numberParser");f.numberParser=Ti;f.inferDecimalSeparator=yt.caching(r=>Ts.get(()=>_s(new Intl.NumberFormat(r).formatToParts(.1).find(e=>e.type==="decimal").value),"."));function Oi(r){return!r||r.trim().length===0?NaN:Number(r)}a(Oi,"numberOf");f.numberOf=Oi});var Ri=E(U=>{"use strict";Object.defineProperty(U,"__esModule",{value:!0});U.DateParts=U.formatData=U.hasNativeToParts=U.SimpleFormat=U.format=U.ImprovedDateTimeFormat=U.Formatters=void 0;var ie=le(),K=Bt(),De=qe(),Br=Fe(),au=me(),su=z(),Ci=ve(),Ms=Ce(),Pe=class{static create(e,t=K.defaultOptions){return typeof t=="string"?new Ht(e,t):typeof t.format=="string"?new Ht(e,t.format):new gt(e,t)}static isNativelySupported(e,t=K.defaultOptions){let n=this.dateTimeFormat(e,t);return typeof n.formatToParts=="function"&&n.formatToParts(new Date).length>0}static dateTimeFormat(e,t){return new Intl.DateTimeFormat(e,Object.assign(Object.assign({},t),{timeZone:"UTC"}))}};a(Pe,"Formatters");ie.__decorate([Ci.cache],Pe,"create",null);ie.__decorate([Ci.cache],Pe,"isNativelySupported",null);U.Formatters=Pe;var gt=class{constructor(e,t,n=gt.create(e,t)){this.locale=e,this.options=t,this.delegate=n}static create(e,t){let n=Object.assign({},t),i=Object.keys(n).length,s=Pe.dateTimeFormat(e,n);if(Object.keys(n).length!=i)throw new Error(`Unsupported DateTimeFormat options provided: ${JSON.stringify(t)}`);return s}format(e){return Br.characters(this.delegate.format(e)).join("")}formatToParts(e=new Date){return Pe.isNativelySupported(this.locale,this.options)?this.delegate.formatToParts(e):L.create(this.locale,this.options).toParts(typeof e=="number"?new Date(e):e)}resolvedOptions(){return this.delegate.resolvedOptions()}};a(gt,"ImprovedDateTimeFormat");U.ImprovedDateTimeFormat=gt;function ou(r,e,t=K.defaultOptions){if(r==null)throw new Error("Date format requires a value");return Pe.create(e,t).format(r)}a(ou,"format");U.format=ou;var Ht=class{constructor(e,t){this.locale=e,this.value=t,this.partsInOrder=K.partsFrom(t),this.options=K.optionsFrom(this.partsInOrder)}format(e){return this.formatToParts(e).map(t=>t.value).join("")}formatToParts(e=new Date){let t=typeof e=="number"?new Date(e):e,n=L.create(this.locale,this.options).toParts(t);return this.partsInOrder.map(i=>({type:i.type,value:this.valueFor(n,i.type,i.value)}))}valueFor(e,t,n){return t==="literal"?n:K.valueFromParts(e,t)}resolvedOptions(){return Object.assign(Object.assign({},this.options),{locale:this.locale})}};a(Ht,"SimpleFormat");U.SimpleFormat=Ht;U.hasNativeToParts=typeof Intl.DateTimeFormat.prototype.formatToParts=="function";function cu(r,e,t=K.defaultOptions,n=U.hasNativeToParts){let i=Pe.create(e,t);return n?i.formatToParts(r):L.create(e,t).toParts(r)}a(cu,"formatData");U.formatData=cu;var L=class{constructor(e,t=K.defaultOptions,n=3333,i=11,s=20,o=K.Weekday.Friday,c=Ms.Numerals.get(e)){this.locale=e,this.options=t,this.yearValue=n,this.monthValue=i,this.dayValue=s,this.weekdayValue=o,this.numerals=c}static create(e,t=K.defaultOptions){return new L(e,t)}get formatter(){return Pe.create(this.locale,this.options)}get formatted(){return this.formatter.format(K.date(this.yearValue,this.monthValue,this.dayValue))}get months(){return K.Months.create(this.locale,K.Months.dataFor(this.locale,this.options,!1))}get month(){return K.months(this.locale,this.options,!1)[this.monthValue-1]}get weekdays(){return new K.Weekdays(K.Weekdays.dataFor(this.locale,this.options,!1))}get weekday(){return K.weekdays(this.locale,this.options,!1)[this.weekdayValue-1]}get year(){return this.numerals.format(this.yearValue)}get day(){return this.numerals.format(this.dayValue)}get learningNamesPattern(){let e=a(i=>`(?<${i}>${this[i]})`,"template"),n=`(?:${Object.keys(this.options).map(i=>e(i)).join("|")})`;return Br.NamedRegExp.create(n)}get actualNamesPattern(){let e=Ms.digits(this.locale),t=this.learningNamesPattern,n=su.array(t.iterate(this.formatted),au.map(s=>{if(Br.isNamedMatch(s)){let[o]=s.filter(c=>Boolean(c.value)).map(c=>c.name);if(!o)throw new Error;if(o=="year")return`(?<year>[${e}]{4})`;if(o=="day")return`(?<day>[${e}]{1,2})`;if(o=="month")return`(?<month>(?:[${e}]{1,2}|${this.months.pattern}))`;if(o=="weekday")return`(?<weekday>${this.weekdays.pattern})`}else return`(?<literal>[${s}]+?)`})),i="^"+n.join("")+"$";return Br.NamedRegExp.create(i)}toParts(e){let t=this.actualNamesPattern,n=this.formatter.format(e),i=t.match(n);if(i.length===0)throw new Error(`${t} did not match ${n}`);let s=i.map(o=>({type:this.getType(o.name,o.value),value:o.value}));return this.collapseLiterals(s)}collapseLiterals(e){for(let t=0;t<e.length;t++){let n=e[t];if(n.type==="literal"){let i=t+1;for(;;){let s=e[i];if(!(s&&s.type==="literal"))break;n.value=n.value+s.value,e.splice(i,1)}}}return e}getType(e,t){return e==="month"||e==="weekday"?this.parsable(this.months,t)?"month":this.parsable(this.weekdays,t)?"weekday":"literal":e}parsable(e,t){try{return Boolean(e.parse(t))}catch(n){return!1}}};a(L,"DateParts");ie.__decorate([De.lazy],L.prototype,"formatter",null);ie.__decorate([De.lazy],L.prototype,"formatted",null);ie.__decorate([De.lazy],L.prototype,"months",null);ie.__decorate([De.lazy],L.prototype,"month",null);ie.__decorate([De.lazy],L.prototype,"weekdays",null);ie.__decorate([De.lazy],L.prototype,"weekday",null);ie.__decorate([De.lazy],L.prototype,"year",null);ie.__decorate([De.lazy],L.prototype,"day",null);ie.__decorate([De.lazy],L.prototype,"learningNamesPattern",null);ie.__decorate([De.lazy],L.prototype,"actualNamesPattern",null);ie.__decorate([Ci.cache],L,"create",null);U.DateParts=L});var $s=E(k=>{"use strict";Object.defineProperty(k,"__esModule",{value:!0});k.FromFormatStringWeekdayExtractor=k.FromFormatStringMonthExtractor=k.FromFormatStringDataExtractor=k.NativeDataExtractor=k.valueFromParts=k.BaseDataExtractor=k.exactFormat=k.weekdays=k.Weekdays=k.months=k.Months=void 0;var Ns=lt(),js=ui(),ht=Ri(),Ii=Fe(),Se=Ce(),lu=Ye(),X=class extends Se.DatumLookup{constructor(e,t){super(e);this.numerals=Se.Numerals.get(t)}parse(e){let t=lu.get(()=>this.numerals.parse(e));return isNaN(t)?super.parse(Se.cleanValue(e)):t}static get(e,t=[]){return X.cache[e]=X.cache[e]||X.create(e,t)}static set(e,t){return X.cache[e]=t}static create(e,t=[]){return new X([...X.generateData(e),...t],e)}static generateData(e){return Ns.flatten(X.formats.map(t=>X.dataFor(e,t)))}static dataFor(e,t,n=ht.hasNativeToParts){return Fs(e,t,n).map((i,s)=>({name:i,value:s+1}))}};a(X,"Months");k.Months=X;X.formats=[{month:"long"},{month:"short"},{year:"numeric",month:"long",day:"numeric"},{year:"numeric",month:"short",day:"numeric"}];X.cache={};function Ls(r,e){let t=[];for(let n=r;n<=e;n++)t.push(n);return t}a(Ls,"range");var qs={};function Fs(r,e="long",t=ht.hasNativeToParts){let n=JSON.stringify({locale:r,monthFormat:e,native:t});return qs[n]=qs[n]||(()=>{let i=Object.assign({},typeof e=="string"?{month:e}:e);if(!i.month)return[];let s=Ls(1,12).map(o=>js.date(2e3,o,1));return t?new zt(r,i,s,"month").extract().map(Se.cleanValue):new Re(r,i,s).extract().map(Se.cleanValue)})()}a(Fs,"months");k.months=Fs;var Z=class extends Se.DatumLookup{parse(e){return super.parse(Se.cleanValue(e))}static get(e,t=[]){return Z.cache[e]=Z.cache[e]||Z.create(e,t)}static set(e,t){return Z.cache[e]=t}static create(e,t=[]){return new Z([...Z.generateData(e),...t])}static generateData(e){return Ns.flatten(Z.formats.map(t=>Z.dataFor(e,t)))}static dataFor(e,t,n=ht.hasNativeToParts){return Ei(e,t,n).map((i,s)=>({name:i,value:s+1}))}};a(Z,"Weekdays");k.Weekdays=Z;Z.formats=[{weekday:"long"},{weekday:"short"},{year:"numeric",month:"numeric",day:"numeric",weekday:"long"},{year:"numeric",month:"numeric",day:"numeric",weekday:"short"}];Z.cache={};var Ks={};function Ei(r,e="long",t=ht.hasNativeToParts){let n=JSON.stringify({locale:r,weekdayFormat:e,native:t});return Ks[n]=Ks[n]||(()=>{let i=Object.assign({},typeof e=="string"?{weekday:e}:e);if(!i.weekday)return[];let s=Ls(1,7).map(o=>js.date(2e3,1,o+2));return t?new zt(r,i,s,"weekday").extract().map(Se.cleanValue):new Gr(r,i,s).extract().map(Se.cleanValue)})()}a(Ei,"weekdays");k.weekdays=Ei;function ki(r,e,t){let n=ht.Formatters.create(r,e);return t.map(i=>n.format(i))}a(ki,"exactFormat");k.exactFormat=ki;var Gt=class{constructor(e,t,n,i){this.locale=e,this.options=t,this.dates=n,this.partType=i}};a(Gt,"BaseDataExtractor");k.BaseDataExtractor=Gt;function Us(r,e){return r.filter(t=>t.type===e).map(t=>t.value).join("")}a(Us,"valueFromParts");k.valueFromParts=Us;var zt=class extends Gt{extract(){let e=ht.Formatters.create(this.locale,this.options);return this.dates.map(t=>Us(e.formatToParts(t),this.partType))}};a(zt,"NativeDataExtractor");k.NativeDataExtractor=zt;var Vt=class extends Gt{extract(){let e=Object.keys(this.options).length==1,t=ki(this.locale,this.options,this.dates);if(e)return t;let n=ki(this.locale,{[this.partType]:this.options[this.partType]},this.dates),i=this.diff(t),s=[];for(let o=0;o<n.length;o++){let c=t[o],l=n[o],u=i[o];s.push(c.indexOf(l)!=-1&&l.length>u.length&&isNaN(parseInt(u))?l:u)}return s}diff(e){return Ii.different(e)}};a(Vt,"FromFormatStringDataExtractor");k.FromFormatStringDataExtractor=Vt;var Re=class extends Vt{constructor(e,t,n){super(e,t,n,"month")}diff(e){if(!this.options.weekday)return super.diff(e);let t=[],n=Ei(this.locale,this.options,!1),i=n[this.day(this.dates[8])];for(let s=0;s<e.length;s++){let c=this.replaceYearMonthDay(e[s]).replace(this.weekday(n,s),i);t[s]=this.restoreYearMonthDay(c)}return super.diff(t)}weekday(e,t){return e[this.day(this.dates[t])]}replaceYearMonthDay(e){return Ii.replace(Re.replaceYMD,e,t=>{let n=t[1],i=t[2];if(i==="\u5E74")return`${n}year`;if(i==="\u6708")return`${n}month`;if(i==="\u65E5")return`${n}day`;throw new Error(`Unknown delimiter ${i}`)})}restoreYearMonthDay(e){return Ii.replace(Re.restoreYMD,e,t=>{let n=t[1];if(n==="year")return"\u5E74";if(n==="month")return"\u6708";if(n==="day")return"\u65E5";throw new Error(`Unknown delimiter ${n}`)})}day(e){let t=e.getUTCDay();return t==0?6:t-1}};a(Re,"FromFormatStringMonthExtractor");k.FromFormatStringMonthExtractor=Re;Re.replaceYMD=/(\d)([年月日])/g;Re.restoreYMD=/(year|month|day)/g;var Gr=class extends Vt{constructor(e,t,n){super(e,t,n,"weekday")}diff(e){if(!this.options.day)return super.diff(e);let t=[],n=this.dates[0].getUTCDate().toString();for(let i=0;i<e.length;i++){let s=e[i],o=this.convertToNumeral(this.dates[i].getUTCDate()),c=s.replace(o,n);t[i]=c}return super.diff(t)}convertToNumeral(e){return Se.numberFormatter(this.locale).format(e)}};a(Gr,"FromFormatStringWeekdayExtractor");k.FromFormatStringWeekdayExtractor=Gr});var Bt=E(bt=>{"use strict";Object.defineProperty(bt,"__esModule",{value:!0});var zr=le();zr.__exportStar(ui(),bt);zr.__exportStar(Ri(),bt);zr.__exportStar(vt(),bt);zr.__exportStar($s(),bt)});var Vr=E(wt=>{"use strict";Object.defineProperty(wt,"__esModule",{value:!0});wt.StoppedClock=wt.SystemClock=void 0;var _i=class{now(){return new Date}};a(_i,"SystemClock");wt.SystemClock=_i;var Mi=class{constructor(e){this.value=e}now(){return this.value}};a(Mi,"StoppedClock");wt.StoppedClock=Mi});var vt=E(w=>{"use strict";Object.defineProperty(w,"__esModule",{value:!0});w.localeParser=w.simpleParser=w.parser=w.defaultParserOptions=w.formatBuilder=w.optionsFrom=w.partsFrom=w.formatRegex=w.formatFrom=w.Days=w.SmartDate=w.Pivot=w.InferYear=w.InferDirection=w.InferYearViaWeekday=w.compositeDateFactory=w.DefaultDateFactory=w.dateFrom=w.DateTimeFormatPartParser=w.DateParser=w.escapeCharacters=w.RegexBuilder=w.parse=void 0;var Wr=le(),uu=qe(),du=lt(),Jr=Fe(),C=Bt(),Q=Ce(),Hs=z(),Ni=me(),ji=ve(),pu=Ye(),Yr=Vr(),Bs=Nt();function fu(r,e,t,n=C.hasNativeToParts){return Js(e,t,n).parse(r)}a(fu,"parse");w.parse=fu;var Ie=class{constructor(e,t=C.defaultOptions,n){this.locale=e,this.options=t,this.formatted=n}static create(e,t=C.defaultOptions,n=C.hasNativeToParts){return typeof t=="string"?Ui(e,t):typeof t.format=="string"?Ui(e,t.format,t.strict):new Ie(e,t,C.formatData(new Date,e,t,n))}get pattern(){let e=this.formatted.map((t,n)=>{switch(t.type){case"year":return`(?<year>[${Q.digits(this.locale)}]{${this.lengthOf(t.value)}})`;case"month":return`(?<month>${this.monthsPattern()})`;case"day":return`(?<day>[${Q.digits(this.locale)}]{1,2})`;case"weekday":return`(?<weekday>${C.Weekdays.get(this.locale).pattern.toLocaleLowerCase(this.locale)})`;default:{let i=du.unique(Jr.characters(Gs(this.addExtraLiterals(t)))).join("").replace(" ","\\s"),o=n===this.formatted.length-1?"*":"+";return`[${i}]${o}?`}}}).join("");return Q.atBoundaryOnly(e)}lengthOf(e){return e.length===2||e==="2-digit"?2:4}addExtraLiterals(e){return this.options.strict?e.value:this.options.format?e.value+(this.options.separators||Q.boundaryDelimiters):e.value+(this.options.separators||Q.boundaryDelimiters+Q.extraDelimiters)}monthsPattern(){let e=`[${Q.digits(this.locale)}]{1,2}`,t=C.Months.get(this.locale).pattern.toLocaleLowerCase(this.locale);return this.options.month==="2-digit"||this.options.month==="numeric"?e:this.options.month==="short"||this.options.month==="long"?t:`(?:${e}|${t})`}};a(Ie,"RegexBuilder");Wr.__decorate([uu.lazy],Ie.prototype,"pattern",null);Wr.__decorate([ji.cache],Ie,"create",null);w.RegexBuilder=Ie;function Gs(r){return r.replace(/[\-]/g,"\\$&")}a(Gs,"escapeCharacters");w.escapeCharacters=Gs;var xt=class{static create(e,t=C.defaultOptions,n=C.hasNativeToParts){let i=Ie.create(e,t,n).pattern;return Q.mappingParser(Wt.create(Jr.NamedRegExp.create(i),e),s=>zs(s,e,typeof t=="object"?t.factory:void 0))}};a(xt,"DateParser");Wr.__decorate([ji.cache],xt,"create",null);w.DateParser=xt;var Wt=class{static create(e,t){return Q.preProcess(Q.mappingParser(Q.namedRegexParser(e),n=>this.convert(n,t)),n=>this.preProcess(n,t))}static convert(e,t){return e.map(n=>({type:n.name,value:n.value.toLocaleUpperCase(t)}))}static preProcess(e,t){return e.toLocaleLowerCase(t)}};a(Wt,"DateTimeFormatPartParser");Wr.__decorate([ji.cache],Wt,"create",null);w.DateTimeFormatPartParser=Wt;function zs(r,e,t=new Xr){let n=Q.numberParser(".",e),i=r.find(b=>b.type==="day");if(!i)throw new Error("No day found");let s=n.parse(i.value),o=r.find(b=>b.type==="month");if(!o)throw new Error("No month found");let c=C.Months.get(e).parse(o.value),l=r.find(b=>b.type==="year"),u=l?n.parse(l.value):void 0,v=r.find(b=>b.type==="weekday"),D=v?pu.get(()=>C.Weekdays.get(e).parse(v.value)):void 0;return t.create({year:u,month:c,day:s,weekday:D})}a(zs,"dateFrom");w.dateFrom=zs;var Xr=class{create({year:e,month:t,day:n}){if(typeof e=="undefined")throw new Error("No year found");return C.date(e,t,n)}};a(Xr,"DefaultDateFactory");w.DefaultDateFactory=Xr;var Li=class{constructor(e){this.factories=e}create(e){for(let t of this.factories)try{return t.create(e)}catch(n){}throw new Error(`Unable to create date for ${JSON.stringify(e)}`)}};a(Li,"CompositeDateFactory");function mu(...r){return new Li(r)}a(mu,"compositeDateFactory");w.compositeDateFactory=mu;var Jt=class{constructor(e){this.clock=e}static create(e=new Yr.SystemClock){return new Jt(e)}create({year:e,month:t,day:n,weekday:i}){if(e)return C.date(e,t,n);if(!i)throw new Error("No weekday provided");let s=this.candidates(t,n).find(o=>C.weekdayOf(o)===i);if(s)return s;throw new Error("No candidate date found that matches")}candidates(e,t){let n=Ee.startOf(this.clock.now());return Hs.array(Bs.range(0,-6),Ni.zip(Bs.range(1,6)),Ni.flatMap(i=>i),Q.mapIgnoreError(i=>C.date(C.yearOf(n)+i,e,t)))}};a(Jt,"InferYearViaWeekday");w.InferYearViaWeekday=Jt;var Yt;(function(r){r[r.Before=-1]="Before",r[r.After=1]="After"})(Yt=w.InferDirection||(w.InferDirection={}));var ge=class{constructor(e,t){this.direction=t,this.date=Ee.startOf(e)}static before(e){return new ge(e,Yt.Before)}static after(e){return new ge(e,Yt.After)}static sliding(e=new Yr.SystemClock){let t=e.now();return ge.before(C.date(C.yearOf(t)+50,1,1))}create({year:e,month:t,day:n}){if(e&&e<10)throw new Error("Illegal year");if(e&&e>=100&&e<1e3)throw new Error("Illegal year");if(e&&e>=1e3)return C.date(e,t,n);let i=this.calculateYear(e),s=C.date(i,t,n);if(this.direction==Yt.Before&&s<this.date||this.direction==Yt.After&&s>this.date)return s;let o=this.calculateYearIncrement(e);return s.setUTCFullYear(s.getUTCFullYear()+o*this.direction),s}calculateYearIncrement(e){return typeof e=="undefined"?1:100}calculateYear(e){if(typeof e=="undefined")return this.date.getUTCFullYear();let t=Math.floor(this.date.getUTCFullYear()/100)*100;return e+t}};a(ge,"InferYear");w.InferYear=ge;var qi=class{static on(e){return ge.before(C.date(e,1,1))}static sliding(e=new Yr.SystemClock){return ge.sliding(e)}};a(qi,"Pivot");w.Pivot=qi;var Fi=class{constructor(e=new Yr.SystemClock){this.clock=e}create(e){return typeof e.year=="undefined"?ge.after(this.clock.now()).create(e):ge.sliding(this.clock).create(e)}};a(Fi,"SmartDate");w.SmartDate=Fi;var Ee=class{static startOf(e){return C.date(C.yearOf(e),C.monthOf(e),C.dayOf(e))}static add(e,t){let n=new Date(e.getTime());return n.setUTCDate(e.getUTCDate()+t),n}static subtract(e,t){return Ee.add(e,t*-1)}static between(e,t){return Math.abs((e.getTime()-t.getTime())/Ee.milliseconds)}};a(Ee,"Days");w.Days=Ee;Ee.milliseconds=24*60*60*1e3;function Vs(r,e){if(r==="year"){if(e===4)return"numeric";if(e===2)return"2-digit"}if(r==="month"){if(e===4)return"long";if(e===3)return"short";if(e===2)return"2-digit";if(e===1)return"numeric"}if(r==="day"){if(e===2)return"2-digit";if(e===1)return"numeric"}if(r==="weekday"){if(e===4)return"long";if(e===3)return"short"}throw new Error(`Illegal Argument: ${r} ${e}`)}a(Vs,"formatFrom");w.formatFrom=Vs;w.formatRegex=Jr.NamedRegExp.create("(?:(?<year>y+)|(?<month>M+)|(?<day>d+)|(?<weekday>E+))","g");function Ki(r){return Hs.array(w.formatRegex.iterate(r),Ni.map(e=>{if(Jr.isNamedMatch(e)){let[t]=e.filter(s=>Boolean(s.value)),n=t.name,i=Vs(n,t.value.length);return{type:n,value:i}}else return{type:"literal",value:e}}))}a(Ki,"partsFrom");w.partsFrom=Ki;function Ws(r){let e=typeof r=="string"?Ki(r):r,t=["year","month","day","weekday"];return e.filter(n=>t.indexOf(n.type)!=-1).reduce((n,i)=>(n[i.type]=i.value,n),typeof r=="string"?{format:r}:{})}a(Ws,"optionsFrom");w.optionsFrom=Ws;function Ui(r,e,t=!1){return new Ie(r,Object.assign(Object.assign({},Ws(e)),{strict:t}),Ki(e))}a(Ui,"formatBuilder");w.formatBuilder=Ui;w.defaultParserOptions=[{year:"numeric",month:"long",day:"numeric",weekday:"long"},{year:"numeric",month:"short",day:"numeric",weekday:"short"},{year:"numeric",month:"numeric",day:"numeric"},{year:"numeric",month:"short",day:"numeric"},{year:"numeric",month:"long",day:"numeric"}];function Js(r,e,t=C.hasNativeToParts){return typeof e=="string"?Ys(r,e,t):$i(r,e,t)}a(Js,"parser");w.parser=Js;function Ys(r,e,t=C.hasNativeToParts){return xt.create(r,e,t)}a(Ys,"simpleParser");w.simpleParser=Ys;function $i(r,e,t=C.hasNativeToParts){return e?xt.create(r,e,t):Q.or(...w.defaultParserOptions.map(n=>$i(r,n,t)))}a($i,"localeParser");w.localeParser=$i});var Xs=E(Zr=>{"use strict";Object.defineProperty(Zr,"__esModule",{value:!0});Zr.currencies=void 0;Zr.currencies={AFN:{decimals:2,symbols:["Afs","\u060B"]},EUR:{decimals:2,symbols:["\u20AC"]},ALL:{decimals:2,symbols:["L"]},DZD:{decimals:2,symbols:["DA"]},USD:{decimals:2,symbols:["$","US$"]},AOA:{decimals:2,symbols:["Kz"]},XCD:{decimals:2,symbols:["EC$","$"]},ARS:{decimals:2,symbols:["$"]},AMD:{decimals:2,symbols:["\u058F"]},AWG:{decimals:2,symbols:["\u0192"]},AUD:{decimals:2,symbols:["A$","AU$","AUD","$"]},AZN:{decimals:2,symbols:["\u20BC","A.M."]},BSD:{decimals:2,symbols:["B$","$"]},BHD:{decimals:3,symbols:["BD"]},BDT:{decimals:2,symbols:["\u09F3"]},BBD:{decimals:2,symbols:["Bds$","$"]},BYN:{decimals:2,symbols:["Br"]},BZD:{decimals:2,symbols:["Bz$","$"]},XOF:{decimals:0,symbols:["F"]},BMD:{decimals:2,symbols:["BD$","$"]},INR:{decimals:2,symbols:["\u20B9","Rs"]},BTN:{decimals:2,symbols:["Nu"]},BOB:{decimals:2,symbols:["Bs"]},BOV:{decimals:2,symbols:[]},BAM:{decimals:2,symbols:["KM"]},BWP:{decimals:2,symbols:["P"]},NOK:{decimals:2,symbols:["kr"]},BRL:{decimals:2,symbols:["R$"]},BND:{decimals:2,symbols:["B$","$"]},BGN:{decimals:2,symbols:["\u043B\u0432.","\u043B\u0432"]},BIF:{decimals:0,symbols:["FBu"]},CVE:{decimals:2,symbols:[]},KHR:{decimals:2,symbols:["\u17DB"]},XAF:{decimals:0,symbols:[]},CAD:{decimals:2,symbols:["C$","CAD$","$","\xA2"]},KYD:{decimals:2,symbols:["CI$","$"]},CLP:{decimals:0,symbols:["CLP$","$"]},CLF:{decimals:4,symbols:[]},CNY:{decimals:2,symbols:["\xA5","\uFFE5"]},COP:{decimals:2,symbols:["COL$","$"]},COU:{decimals:2,symbols:["COU$"]},KMF:{decimals:0,symbols:["CF"]},CDF:{decimals:2,symbols:["CF"]},NZD:{decimals:2,symbols:["NZ$","$"]},CRC:{decimals:2,symbols:["\u20A1"]},HRK:{decimals:2,symbols:["kn"]},CUP:{decimals:2,symbols:["$MN","$"]},CUC:{decimals:2,symbols:["$"]},ANG:{decimals:2,symbols:["\u0192","NA\u0192","CMg"]},CZK:{decimals:2,symbols:["K\u010D"]},DKK:{decimals:2,symbols:["kr","kr."]},DJF:{decimals:0,symbols:["Fdj"]},DOP:{decimals:2,symbols:["RD$","$"]},EGP:{decimals:2,symbols:["LE","\xA3"]},SVC:{decimals:2,symbols:[]},ERN:{decimals:2,symbols:["Nfk"]},SZL:{decimals:2,symbols:["E"]},ETB:{decimals:2,symbols:["Br"]},FKP:{decimals:2,symbols:["\xA3"]},FJD:{decimals:2,symbols:["F$","FJ$","$"]},XPF:{decimals:0,symbols:["\u20A3"]},GMD:{decimals:2,symbols:["D"]},GEL:{decimals:2,symbols:["\u20BE"]},GHS:{decimals:2,symbols:["GH\u20B5"]},GIP:{decimals:2,symbols:["\xA3"]},GTQ:{decimals:2,symbols:["Q"]},GBP:{decimals:2,symbols:["\xA3"]},GNF:{decimals:0,symbols:["FG"]},GYD:{decimals:2,symbols:["G$","GY$","$"]},HTG:{decimals:2,symbols:["Gde.","G"]},HNL:{decimals:2,symbols:["L"]},HKD:{decimals:2,symbols:["\u5143","HK$","$"]},HUF:{decimals:2,symbols:["Ft"]},ISK:{decimals:0,symbols:["kr"]},IDR:{decimals:2,symbols:["Rp","Rs"]},XDR:{decimals:0,symbols:[]},IRR:{decimals:2,symbols:["\uFDFC"]},IQD:{decimals:3,symbols:["\u062F.\u0639"]},ILS:{decimals:2,symbols:["\u20AA"]},JMD:{decimals:2,symbols:["J$","$"]},JPY:{decimals:0,symbols:["\u5186","\xA5","\uFFE5"]},JOD:{decimals:3,symbols:["JD"]},KZT:{decimals:2,symbols:["\u20B8"]},KES:{decimals:2,symbols:["Ksh","KSh"]},KPW:{decimals:2,symbols:["\u20A9"]},KRW:{decimals:0,symbols:["\u20A9"]},KWD:{decimals:3,symbols:["KD","\u062F.\u0643"]},KGS:{decimals:2,symbols:["\u0441\u043E\u043C"]},LAK:{decimals:2,symbols:["\u20AD"]},LBP:{decimals:2,symbols:["\u0644.\u0644.","LL","\xA3"]},LSL:{decimals:2,symbols:["M"]},ZAR:{decimals:2,symbols:["R"]},LRD:{decimals:2,symbols:["Lib$","L$","$"]},LYD:{decimals:3,symbols:["LD"]},CHF:{decimals:2,symbols:["Fr"]},MOP:{decimals:2,symbols:["MOP$"]},MKD:{decimals:2,symbols:["DEN","\u0434\u0435\u043D"]},MGA:{decimals:2,symbols:["Ar"]},MWK:{decimals:2,symbols:["MK"]},MYR:{decimals:2,symbols:["RM"]},MVR:{decimals:2,symbols:["\u0783","Rf","MRF"]},MRU:{decimals:2,symbols:[]},MUR:{decimals:2,symbols:["\u20A8"]},XUA:{decimals:0,symbols:[]},MXN:{decimals:2,symbols:["$"]},MXV:{decimals:2,symbols:[]},MDL:{decimals:2,symbols:["L"]},MNT:{decimals:2,symbols:["\u20AE"]},MAD:{decimals:2,symbols:["DH"]},MZN:{decimals:2,symbols:["MT","MTn"]},MMK:{decimals:2,symbols:["K"]},NAD:{decimals:2,symbols:["N$","$"]},NPR:{decimals:2,symbols:["N\u20A8","\u0930\u0941","\u20A8","Re"]},NIO:{decimals:2,symbols:["C$"]},NGN:{decimals:2,symbols:["\u20A6"]},OMR:{decimals:3,symbols:["\u0631.\u0639."]},PKR:{decimals:2,symbols:["\u20A8","Rs"]},PAB:{decimals:2,symbols:["B/."]},PGK:{decimals:2,symbols:["K"]},PYG:{decimals:0,symbols:["\u20B2"]},PEN:{decimals:2,symbols:["S/."]},PHP:{decimals:2,symbols:["\u20B1"]},PLN:{decimals:2,symbols:["z\u0142"]},QAR:{decimals:2,symbols:["QR"]},RON:{decimals:2,symbols:["lei"]},RUB:{decimals:2,symbols:["\u20BD"]},RWF:{decimals:0,symbols:["FRw"]},SHP:{decimals:2,symbols:["\xA3"]},WST:{decimals:2,symbols:["WS$"]},STN:{decimals:2,symbols:["Db","\u20A1"]},SAR:{decimals:2,symbols:["SR"]},RSD:{decimals:2,symbols:["\u0434\u0438\u043D","din"]},SCR:{decimals:2,symbols:["SRe"]},SLL:{decimals:2,symbols:["Le"]},SGD:{decimals:2,symbols:["S$","$"]},XSU:{decimals:0,symbols:["Sucre"]},SBD:{decimals:2,symbols:["$","SI$"]},SOS:{decimals:2,symbols:["Sh.So."]},SSP:{decimals:2,symbols:["Db","\xA3"]},LKR:{decimals:2,symbols:["Rs","\u0DBB\u0DD4","\u0BB0\u0BC2"]},SDG:{decimals:2,symbols:["\u062C.\u0633","sud\xA3","\xA3"]},SRD:{decimals:2,symbols:["$"]},SEK:{decimals:2,symbols:["kr"]},CHE:{decimals:2,symbols:[]},CHW:{decimals:2,symbols:[]},SYP:{decimals:2,symbols:["syr\xA3","LS","\xA3"]},TWD:{decimals:2,symbols:["NT$","$"]},TJS:{decimals:2,symbols:["SM"]},TZS:{decimals:2,symbols:["TSh"]},THB:{decimals:2,symbols:["\u0E3F"]},TOP:{decimals:2,symbols:["T$"]},TTD:{decimals:2,symbols:["TT$","$"]},TND:{decimals:3,symbols:["DT"]},TRY:{decimals:2,symbols:["YTL","\u20BA"]},TMT:{decimals:2,symbols:["T"]},UGX:{decimals:0,symbols:["Ush"]},UAH:{decimals:2,symbols:["\u20B4"]},AED:{decimals:2,symbols:["DH","\u062F.\u0625","Dhs"]},USN:{decimals:2,symbols:[]},UYU:{decimals:2,symbols:["$U","$"]},UYI:{decimals:0,symbols:[]},UYW:{decimals:4,symbols:[]},UZS:{decimals:2,symbols:["So'm"]},VUV:{decimals:0,symbols:["VT"]},VES:{decimals:2,symbols:["Bs.S"]},VED:{decimals:2,symbols:[]},VND:{decimals:0,symbols:["\u20AB","\u0111"]},YER:{decimals:2,symbols:["\uFDFC'"]},ZMW:{decimals:2,symbols:["K","ZK"]},ZWL:{decimals:2,symbols:[]},XBA:{decimals:0,symbols:[]},XBB:{decimals:0,symbols:[]},XBC:{decimals:0,symbols:[]},XBD:{decimals:0,symbols:[]},XTS:{decimals:0,symbols:[]},XXX:{decimals:0,symbols:[]},XAU:{decimals:0,symbols:[]},XPD:{decimals:0,symbols:[]},XPT:{decimals:0,symbols:[]},XAG:{decimals:0,symbols:[]}}});var tn=E(x=>{"use strict";Object.defineProperty(x,"__esModule",{value:!0});x.IntegerGroupParser=x.PartsFromFormat=x.NumberFormatPartParser=x.MoneyParser=x.RegexBuilder=x.symbolFor=x.CurrencySymbols=x.parseToParts=x.parser=x.parse=x.FormatToParts=x.toPartsPonyfill=x.format=x.partsFrom=x.hasNativeToParts=x.Formatter=x.decimalsFor=x.moneyFrom=x.money=void 0;var Ze=le(),He=Fe(),he=me(),Ae=z(),yu=lt(),Hi=Xs(),Zs=qe(),J=Ce(),Xt=ve(),gu=Ye();function Qr(r,e){return{amount:e,currency:r}}a(Qr,"money");x.money=Qr;function Bi(r,e,t){let{currency:n}=Ae.single(r,he.filter(l=>l.type==="currency"),he.flatMap(l=>{try{let u=$.get(e).parse(l.value,t&&t.strategy);return[{currency:u,exactMatch:u===l.value}]}catch(u){return[]}}),he.sort(Ae.by("exactMatch",Ae.descending)),he.first()),i=r.filter(l=>l.type==="integer"||l.type==="decimal"||l.type==="fraction"),s=gu.get(()=>r.filter(l=>l.type==="decimal")[0].value,"."),o=i.map(l=>l.value).join(""),c=J.numberParser(s,e).parse(o);return Qr(n,c)}a(Bi,"moneyFrom");x.moneyFrom=Bi;function Qs(r){let e=Hi.currencies[r];return e?e.decimals:2}a(Qs,"decimalsFor");x.decimalsFor=Qs;var Te=class{static create(e,t,n="code"){return new Intl.NumberFormat(t,{currencyDisplay:n,currency:e,style:"currency",minimumFractionDigits:0,maximumFractionDigits:Qs(e)})}};a(Te,"Formatter");Ze.__decorate([Xt.cache],Te,"create",null);x.Formatter=Te;x.hasNativeToParts=typeof Intl.NumberFormat.prototype.formatToParts=="function";function Gi(r,e,t="code",n=x.hasNativeToParts){let i=Te.create(r.currency,e,t);return n?i.formatToParts(r.amount):eo(r,e,t)}a(Gi,"partsFrom");x.partsFrom=Gi;function hu(r,e,t="code"){return Te.create(r.currency,e,t).format(r.amount)}a(hu,"format");x.format=hu;function eo(r,e,t="code"){let n=r.currency,i=r.amount;return Qe.create(n,e,t).format(i)}a(eo,"toPartsPonyfill");x.toPartsPonyfill=eo;var to=Qr("GBP",111222.3333),Qe=class{constructor(e,t,n,i){this.currency=e,this.currencyDisplay=t,this.parser=n,this.locale=i}static create(e,t,n="code"){let i=Te.create(e,t,n).format(to.amount),s=Oe.examplePattern(t).parse(i),o=Zt.buildFrom(s,t),c=et.create(t,o);return new Qe(e,n,c,t)}format(e){let t=Te.create(this.currency,this.locale,this.currencyDisplay);return this.parser.parse(t.format(e))}};a(Qe,"FormatToParts");Ze.__decorate([Xt.cache],Qe,"create",null);x.FormatToParts=Qe;function bu(r,e,t){return Bi(ro(r,e,t),e,t)}a(bu,"parse");x.parse=bu;function vu(r,e){return en.create(r,e)}a(vu,"parser");x.parser=vu;function ro(r,e,t){return et.create(e,t).parse(r)}a(ro,"parseToParts");x.parseToParts=ro;var $=class extends J.DatumLookup{constructor(e,t){super(e.map(n=>({name:J.cleanValue(n.name),value:n.value})),Ae.ascending);this.locale=t}static get(e,t=[]){return $.cache[e]=$.cache[e]||$.create(e,t)}static set(e,t){return $.cache[e]=t}static create(e,t=[]){return new $([...$.generateData(e),...t],e)}static generateData(e){return yu.flatten(Object.keys(Hi.currencies).map(t=>$.dataFor(e,t,Hi.currencies[t])))}static dataFor(e,t,n){return[{name:t,value:t},{name:no(e,t),value:t},...Ae.array(n.symbols,he.flatMap(i=>{let s=[{name:i,value:t}];if($.generateAdditionalSymbols.indexOf(i)!==-1){let o=t.substring(0,2);s.push({name:i+o,value:t}),s.push({name:o+i,value:t}),s.push({name:t+i,value:t})}return s}))]}parse(e,t=J.infer(this.locale)){return super.parse(J.cleanValue(e),t)}};a($,"CurrencySymbols");x.CurrencySymbols=$;$.cache={};$.generateAdditionalSymbols=["$","\xA5","\xA3"];var wu=/[£GBP]+/;function no(r,e,t=x.hasNativeToParts){if(t){let n=Gi(Qr(e,0),r,"symbol"),[i]=n.filter(s=>s.type==="currency");if(!i)throw new Error("No currency found");return i.value}else{let n=Te.create("GBP",r,"symbol").format(1).replace(wu,"@@@"),i=Te.create(e,r,"symbol").format(1),[,s]=He.different([n,i]);return s?s.replace(J.Spaces.pattern,""):"\xA3"}}a(no,"symbolFor");x.symbolFor=no;var Zt=class{static buildFromOptions(e,t){return t&&t.format?this.buildFrom(Oe.format.parse(t.format),e,!0):this.buildPattern(e,t&&t.strict||!1)}static buildPattern(e,t=!1){return this.buildFrom(Gi(to,e),e,t)}static buildFrom(e,t,n=!1){let i=this.buildParts(e,n),[s=""]=e.filter(l=>l.type==="group").map(l=>l.value),o=J.digits(t),c=i.map(l=>{switch(l.type){case"currency":return`(?<currency>${$.get(t).pattern})?`;case"decimal":return`(?<decimal>[${l.value}]?)`;case"fraction":return`(?<fraction>[${o}]*)`;case"integer":return`(?<integer-group>[${o}${J.Spaces.handle(s)}]*[${o}]+)`;default:return`(?<${l.type}>[${J.Spaces.handle(l.value)}]?)`}}).join("");return J.atBoundaryOnly(c)}static buildParts(e,t=!1){let n=[...e];if(!t){let i=n[0],s=n[n.length-1],o={type:"literal",value:" "};i.type==="currency"?(n.push(o,i),n.splice(1,0,o)):s.type==="currency"&&(n.unshift(s,o),n.splice(n.length-2,0,o))}return Ae.array(n,he.filter(i=>i.type!=="group"),he.dedupe(Ae.by("type")))}};a(Zt,"RegexBuilder");x.RegexBuilder=Zt;var en=class{static create(e,t){return J.mappingParser(et.create(e,t),n=>Bi(n,e,t))}};a(en,"MoneyParser");x.MoneyParser=en;var et=class{static create(e,t){let n=typeof t=="string"?t:Zt.buildFromOptions(e,t);return J.mappingParser(J.namedRegexParser(He.NamedRegExp.create(n)),i=>this.convert(i,e))}static convert(e,t){return Ae.array(e,he.filter(n=>Boolean(n.value)),he.flatMap(n=>n.name==="integer-group"?be.digits(t).parse(n.value):[{type:n.name,value:n.value}]))}};a(et,"NumberFormatPartParser");Ze.__decorate([Xt.cache],et,"create",null);x.NumberFormatPartParser=et;var Oe=class{constructor(e,t){this.formatRegex=e,this.integerGroupParser=t}parse(e){return Ae.array(this.formatRegex.iterate(e),he.flatMap(t=>{if(He.isNamedMatch(t)){let[n,i,s]=t.filter(o=>Boolean(o.value));if(n.name==="currency")return[{type:n.name,value:n.value}];{let o=this.integerGroupParser.parse(n.value);return i?[...o,{type:i.name,value:i.value},{type:s.name,value:s.value}]:o}}else return[{type:"literal",value:t}]}))}static get format(){let e=He.NamedRegExp.create("(?:(?<integer-group>(?:i.*i|i))(?:(?<decimal>[^f])(?<fraction>f+))?|(?<currency>C+))");return new Oe(e,be.integerFormat)}static examplePattern(e){let t=J.Numerals.get(e),n=He.NamedRegExp.create(`(?:(?<integer-group>${t.format(1)}.*${t.format(2)})(?:(?<decimal>.)(?<fraction>${t.format(3)}+))?|(?<currency>${$.get(e).pattern}))`);return new Oe(n,be.digits(e))}};a(Oe,"PartsFromFormat");Ze.__decorate([Zs.lazy],Oe,"format",null);Ze.__decorate([Xt.cache],Oe,"examplePattern",null);x.PartsFromFormat=Oe;var be=class{constructor(e){this.regex=e}parse(e){return Ae.array(this.regex.iterate(e),he.map(t=>He.isNamedMatch(t)?{type:"integer",value:t[0].value}:{type:"group",value:t}))}static digits(e){return new be(He.NamedRegExp.create(`(?<integer>[${J.digits(e)}]+)`))}static get integerFormat(){return new be(He.NamedRegExp.create("(?<integer>i+)"))}};a(be,"IntegerGroupParser");Ze.__decorate([Xt.cache],be,"digits",null);Ze.__decorate([Zs.lazy],be,"integerFormat",null);x.IntegerGroupParser=be});var io=E(zi=>{"use strict";Object.defineProperty(zi,"__esModule",{value:!0});var xu=le();xu.__exportStar(tn(),zi)});var rn=E(pe=>{"use strict";Object.defineProperty(pe,"__esModule",{value:!0});pe.implicitMoneyParser=pe.findDecimalSeparator=pe.flexibleMoneyParser=pe.FlexibleMoneyParser=pe.flexibleParse=void 0;var ao=le(),Dt=tn(),ae=Ce(),Du=Fe(),Qt=me(),er=z(),Pu=lt(),Su=ve(),Au=qe(),Tu=Ye();function Ou(r,e="en",t){return new ke(e,t).parse(r)}a(Ou,"flexibleParse");pe.flexibleParse=Ou;var ke=class{constructor(e,t){this.locale=e,this.options=t}get pattern(){return ke.patternFor(this.locale)}static patternFor(e){return Du.NamedRegExp.create(ae.atBoundaryOnly(`(?<currency>${Dt.CurrencySymbols.get(e).pattern})?(?<literal>[${ae.Spaces.spaces}])?(?<number>${ae.numberPattern(e)})(?<literal>[${ae.Spaces.spaces}])?(?<currency>${Dt.CurrencySymbols.get(e).pattern})?`))}parse(e){try{return this.parseSingle(this.pattern.match(e))}catch(t){throw new Error(`Unable to parse ${e}`)}}parseAll(e){return er.array(this.pattern.exec(e),ae.mapIgnoreError(t=>this.parseSingle(t)))}parseSingle(e){let{currency:t}=er.single(e,Qt.filter(s=>s.name==="currency"&&s.value!==void 0),Qt.flatMap(s=>{try{let o=Dt.CurrencySymbols.get(this.locale).parse(s.value,this.options&&this.options.strategy);return[{currency:o,exactMatch:o===s.value}]}catch(o){return[]}}),Qt.sort(er.by("exactMatch",er.descending)),Qt.first()),n=er.single(e,Qt.find(s=>s.name==="number"&&s.value!==void 0)).value,i=ae.numberParser(this.options&&this.options.decimalSeparator||Vi(t,n),this.locale);return Dt.money(t,i.parse(n))}};a(ke,"FlexibleMoneyParser");ao.__decorate([Au.lazy],ke.prototype,"pattern",null);ao.__decorate([Su.cache],ke,"patternFor",null);pe.FlexibleMoneyParser=ke;function Cu(r="en",e){return new ke(r,e)}a(Cu,"flexibleMoneyParser");pe.flexibleMoneyParser=Cu;function so(r){return r==="."?",":"."}a(so,"flip");function Vi(r,e){let t=ae.separatorsOf(e);if(t.length===0)return".";let n=t[t.length-1],i=e.length-e.lastIndexOf(n)-1,s=Dt.decimalsFor(r);if(t.length===1){if(i===3){if(s===3)throw new Error(`Can not parse ${e} as separator is ambiguous`);return so(n)}return ae.decimalSeparator(n)}return Pu.unique(t).length===1?so(n):ae.decimalSeparator(n)}a(Vi,"findDecimalSeparator");pe.findDecimalSeparator=Vi;var Wi=class{constructor(e,t,n=new ae.NumberParser(i=>Tu.get(()=>Vi(e,i),ae.inferDecimalSeparator(t)),t)){this.currency=e,this.parser=n}parse(e){let t=this.parser.parse(e);return{currency:this.currency,amount:t}}parseAll(e){return this.parser.parseAll(e).map(t=>({amount:t,currency:this.currency}))}};a(Wi,"ImplicitMoneyParser");function Ru({currency:r,locale:e="en",strategy:t=ae.infer(e)}){return r?new Wi(Dt.CurrencySymbols.get(e).parse(r,t),e):new ae.FailParser}a(Ru,"implicitMoneyParser");pe.implicitMoneyParser=Ru});var ta=O(ve()),Oo=O(vt()),Co=O(io()),Ro=O(rn()),fn=O(Ce());var oo=O(me()),Ji=O(z());function Iu(r){switch(typeof r){case"undefined":return!0;case"string":return r.trim()==="";case"number":return isNaN(r);case"object":{if(r==null)return!0;if(y.isObject(r))return Object.keys(r).length===0;if(Array.isArray(r))return r.length===0}}return!1}a(Iu,"isEmpty");var _e=class{static parse(e){if(typeof e!="number"&&F.isEmpty(e))return;let t=Number(e);if(!isNaN(t))return t}static isNumber(e){return typeof e=="number"&&!isNaN(e)}};a(_e,"Numbers");var F=class{static noWhitespace(e){return e&&typeof e=="string"?e.replace(/\s+/g,""):""}static startWith(e,t){return e?e.substring(0,t.length)===t:e===t}static endsWith(e,t){return e.substring(e.length-t.length,e.length)===t}static isEmpty(e){return e===void 0||e===null?!0:e.trim().length===0}static isLowerCase(e){return e===e.toLowerCase()&&e!==e.toUpperCase()}static isUpperCase(e){return e===e.toUpperCase()&&e!==e.toLowerCase()}static kebabCase(e){return F.delimiterCase(e,"-")}static snakeCase(e){return F.delimiterCase(e,"_")}static delimiterCase(e,t){return e.replace(/([A-Z][a-z]+|\d+)/gm,`${t}$1`).replace(new RegExp(`^${t}`),"").toLowerCase()}static titleCase(e){return F.isEmpty(e)?"":e.replace(/\w\S*/g,t=>t.charAt(0).toUpperCase()+t.substr(1).toLowerCase())}};a(F,"Strings");function tr(r,e,t){if(e(r))return t(r);switch(typeof r){case"undefined":return;case"object":{if(r===null)return null;if(Array.isArray(r))return r.map(n=>tr(n,e,t));if(y.isObject(r))return y.keys(r).sort().reduce((n,i)=>{let s=r[i];return n[i]=tr(s,e,t),n},{})}}return r}a(tr,"walkValues");function Yi(r,e){switch(typeof r){case"undefined":return;case"object":{if(r===null)return null;if(Array.isArray(r))return r.map(t=>Yi(t,e));if(y.isObject(r))return y.keys(r).sort().reduce((t,n)=>{let i=r[n];return t[e(String(n))]=Yi(i,e),t},{})}}return r}a(Yi,"walkKeys");var y=class{static isObject(e){return e&&typeof e=="object"&&(e.constructor===Object||/Object.*native/.test(e.constructor.toString()))}static keys(e){return Object.keys(e)}static values(e){return Object.keys(e).map(t=>e[t])}static entries(e){return Object.keys(e).map(t=>[t,e[t]])}static removeEmpty(e){return e&&(y.isObject(e)?Object.keys(e).reduce((t,n)=>{let i=y.removeEmpty(e[n]);return Iu(i)||(t[n]=i),t},{}):e)}static sort(e){return e&&(Array.isArray(e)?e.map(y.sort):y.isObject(e)?Object.keys(e).sort().reduce((t,n)=>{let i=e[n];return t[n]=y.sort(i),t},{}):e)}static toLowerCase(e){return typeof e=="string"?e.toLowerCase():Array.isArray(e)?e.map(y.toLowerCase):m(()=>y.isObject(e))?Object.entries(e).reduce((t,[n,i])=>(t[n]=y.toLowerCase(i),t),{}):e}static snakeCase(e){return Yi(e,F.snakeCase)}static filter(e,t){let n=y.keys(e).filter(t);return y.pick(e,...n)}static omit(e,...t){return t.reduce((n,i)=>(Reflect.deleteProperty(n,i),n),e)}static pick(e,...t){return t.reduce((n,i)=>(n[i]=e[i],n),{})}};a(y,"Objects");var S=class{static from(e){return Array.from(e)}static find(e,t){if(e.find)return e.find(t);let[n]=e.filter(t);return n}static findLastIndex(e,t){let n=[...e].reverse().findIndex(t);return n===-1?n:e.length-n-1}static toObject(e){return e.reduce((t,n)=>(Object.keys(n).forEach(i=>{i in t||(t[i]=n[i])}),t),{})}static flatten(e){return e.reduce((t,n)=>t.concat(n),[])}static flatMap(e,t){return e.flatMap?e.flatMap(t):S.flatten(e.map(t))}static unique(e){return Array.from(new Set(e))}static clean(e){return e.filter(Boolean)}static trim(e){return e.map(t=>t.trim())}static includes(e,t){return"includes"in e?e.includes(t):e.indexOf(t)!==-1}static first(e){return e[0]}static last(e){return e[e.length-1]}static safeReverse(e){return e?e.slice().reverse():[]}static shuffle(e){return e.map(t=>({value:t,order:Math.random()})).sort((0,Ji.by)("order")).map(({value:t})=>t)}};a(S,"Arrays");var nn=class{static path(e){let t=[e];for(;e.parentElement;)e=e.parentElement,t.push(e);return t}};a(nn,"Elements");function m(r,e=void 0){try{let t=r();return typeof t=="undefined"?e:t}catch(t){return e}}a(m,"get");function an(r,e=void 0){return g(this,null,function*(){try{let t=yield r();return typeof t=="undefined"?e:t}catch(t){return e}})}a(an,"getAsync");function Eu(r,e){let t=e.toLowerCase(),n=S.find(Object.keys(r),s=>s.toLowerCase()===t);if(!n)return;let i=r[n];return typeof i=="string"?i.trim():i}a(Eu,"getValue");function sn(r,...e){if(!r)return[];if(Array.isArray(r))return S.clean(S.flatten(r.map(t=>sn(t,...e))));if(typeof r=="object"){let[t,...n]=e,i=Eu(r,t);return typeof i=="object"?sn(i,...n):n.length===0&&Boolean(i)?[i]:[]}return[]}a(sn,"getAll");var ee=(()=>typeof self!="undefined"?self:typeof window!="undefined"?window:typeof global!="undefined"?global:typeof module!="undefined"?module:Function("return this")())();function on(r,e,t){let n=r[e];return typeof n=="undefined"?r[e]=t:Array.isArray(n)?n.indexOf(t)==-1&&n.push(t):r[e]=[n,t],r}a(on,"accumulateMultipleValues");function ku(r,e,t,n=i=>i){let i=[],s=0,o;for(;(o=r.exec(e))!=null;)i.push(n(e.substring(s,o.index))),i.push(t(o)),s=r.lastIndex;return i.push(n(e.substring(s))),i.join("")}a(ku,"regexReplace");function co(r){return ku(/\w+/g,r,e=>_u(e[0]))}a(co,"titleCase");function _u(r){return r.substr(0,1).toUpperCase()+r.substr(1).toLowerCase()}a(_u,"caseWord");function lo(r,e){return r.slice(0,e)}a(lo,"limit");function uo(r){return m(()=>S.last(r.constructor.name.split("$")),"")}a(uo,"getClassName");function po(r){return r?r.replace(/\s+/g," ").trim():""}a(po,"cleanText");var $p=new Set(["Unknown","PossibleIdentifier"]),cn=new Set(["HotelName","HotelCode","ChainCode"]);function fo(r){return r&&typeof r=="object"&&r.checkin instanceof Date&&r.checkout instanceof Date}a(fo,"hasSearchDates");var A;(function(c){c.Search="Search",c.RoomsAndRates="RoomsAndRates",c.Confirmation="Confirmation",c.Payment="Payment",c.Group="Group",c.Partial="Partial",c.Unknown="Unknown"})(A||(A={}));var Mu=[A.Payment,A.Confirmation,A.RoomsAndRates,A.Search,A.Partial,A.Group,A.Unknown];function mo(r){return Mu.indexOf(r)}a(mo,"pageRanking");var yo;(function(n){n.Singleton="Singleton",n.ApplicationHost="ApplicationHost",n.DataSource="DataSource"})(yo||(yo={}));function Pt(r){return r?typeof r=="object"&&("integrationId"in r||"clientKey"in r||"apiKey"in r||"identifiers"in r||"type"in r):!1}a(Pt,"isScrapedIdentifiers");var Do=O(Ce());var go=O(ve()),ho=O(qe());function se(r=ee){return r.triptease=r.triptease||{},r.triptease.onboard=r.triptease.onboard||{},{triptease:r.triptease,onboard:r.triptease.onboard}}a(se,"globalObjects");var tt;(function(n){n.Native="native",n.NonNative="non-native",n.NotImplemented="not-implemented"})(tt||(tt={}));function Xi(r,e){return m(()=>e.split(".").reduce((t,n)=>t[n],r))}a(Xi,"getProperty");function bo(r){return r==null?tt.NotImplemented:typeof r=="function"?r.toString().includes("native code")?tt.Native:tt.NonNative:tt.Native}a(bo,"isNative");function vo(r,...e){return e.reduce((t,n)=>(t[n]=bo(Xi(r,n)),t),{})}a(vo,"features");var ln=class{static exposeApi(){let e=se(ee).triptease;e.native||(e.native=ln)}static getProperty(e){let t=Xi(ee,e);return bo(t)!==tt.NonNative?t:Xi(ln.window,e)}static get window(){let e=ee;if(!e.document)return e;try{let t=e.document,n=t.querySelector("[name='triptease.native']");if(n)return n.contentWindow;let i=t.createElement("iframe");return i.style.display="none",i.setAttribute("title","blank"),i.setAttribute("aria-hidden","true"),i.setAttribute("name","triptease.native"),t.documentElement.appendChild(i),i.contentWindow}catch(t){return e}}},te=ln;a(te,"Native"),fe([go.cache],te,"getProperty",1),fe([ho.lazy],te,"window",1);var Nu=/^\d{4}-\d{2}-\d{2}(?:T\d{2}:\d{2}:\d{2}\.\d{3}Z)?$/;function ju(r){return tr(r,e=>typeof e=="string"&&Nu.test(e),e=>{let t=new Date(e);return isNaN(t.valueOf())?e:t})}a(ju,"convertDates");var Lu=te.getProperty("JSON.parse"),qu=te.getProperty("JSON.stringify"),Fu=te.getProperty("Date.prototype.toISOString"),oe=class{static parse(e){return Lu(e)}static parseWithDates(e){return ju(oe.parse(e))}static stringify(e){return qu(this.clean(e))}static clean(e){return tr(e,t=>{let n=typeof t;switch(n){case"undefined":case"string":case"number":case"boolean":return!0;case"object":{if(t===null)return!0;if(Array.isArray(t)||y.isObject(t))return!1;if("toJSON"in t)return!0}}throw new Error(`Illegal JsonValue: ${n} ${t} `)},t=>t instanceof Date?Fu.call(t):t)}};a(oe,"Json");var M=class{static same(e,t){return oe.stringify(e)===oe.stringify(t)}static isSuperset(e,t){return e===null||t===null?M.same(e,t):Array.isArray(e)&&Array.isArray(t)?e.length>t.length?!1:e.every(n=>t.some(i=>M.isSuperset(n,i))):m(()=>y.isObject(e))&&m(()=>y.isObject(t))?Object.keys(e).reduce((n,i)=>n&&M.isSuperset(e[i],t[i]),!0):M.same(e,t)}static compress(e){let t=M.groupValues(e);return this.compressGrouped(t)}static compressGrouped(e){return Object.entries(e).reduce(({shared:t,unique:n},[i,s])=>{if(m(()=>y.isObject(s))){let o=M.compressGrouped(s);Object.keys(o.shared).length>0&&(t[i]=o.shared),o.unique.forEach((c,l)=>{n[l]=n[l]||{},Object.keys(c).length>0&&(n[l][i]=c)})}return Array.isArray(s)&&s.forEach((o,c)=>{n[c]=n[c]||{},S.unique(s.map(l=>oe.stringify(l))).length===1?t[i]=o:o!==void 0&&(n[c][i]=o)}),{shared:t,unique:n}},{shared:{},unique:[]})}static groupValues(e){let t=Array.from(e.reduce((o,c)=>Object.keys(c).reduce((l,u)=>l.add(u),o),new Set)),[n,i]=e.reduce((o,c)=>t.reduce(([l,u],v)=>{let D=c[v];return m(()=>y.isObject(D))?(u[v]=u[v]||[],u[v].push(D)):(l[v]=l[v]||[],l[v].push(D)),[l,u]},o),[{},{}]),s=Object.entries(i).reduce((o,[c,l])=>(o[c]=M.groupValues(l),o),{});return h(h({},n),s)}static decompress(e){return e.unique.map(t=>this.merge(e.shared,t))}static merge(e,t){return[...Object.keys(e),...Object.keys(t)].reduce((i,s)=>{let o=e[s],c=t[s];return m(()=>y.isObject(o))&&m(()=>y.isObject(c))?i[s]=M.merge(o,c):i[s]=c!=null?c:o,i},{})}};a(M,"JsonValues");function H(r,e=!0){return r?(r.indexOf("?")==0&&(r=r.substring(1,r.length)),r.split("&").map(function(t){return t.split("=")}).reduce(function(t,n){let i=n[0],s=n[1];if(!i)return t;let o=wo(s),c=e?Ku(o):o;return on(t,wo(i),c)},{})):{}}a(H,"queryObject");function wo(r){return m(()=>decodeURIComponent(r.replace(/\+/g,"%20")),r)}a(wo,"decode");function Ku(r){try{return oe.parse(r)}catch(e){return r}}a(Ku,"coerce");var un=O(z()),Be=O(me());function xo(r){return r?r.trim().split(/[-_]/).filter(Boolean).map((e,t)=>t===0?e.toLowerCase():t===1&&e.length===2?e.toUpperCase():e):[]}a(xo,"localeParts");function Uu(r){let[e]=xo(r);return e}a(Uu,"languageOf");function Me(r){let e=xo(r);if(e.length!==0)return e.join("-")}a(Me,"cleanLocale");var Zi=class{localeOf(e){return[e.documentElement.lang,e.documentElement.getAttribute("xml:lang")].filter(Boolean)}};a(Zi,"DocumentLocaleDetector");var Qi=class{localeOf(e){var n;let t=H((n=e.defaultView)==null?void 0:n.location.search).lang;return typeof t!="string"?[]:[t]}};a(Qi,"QueryStringLocaleDetector");var St=class{constructor(e){this.tld=e}static create(e){let[,t]=m(()=>e.defaultView.location.hostname.match(St.pattern))||[];return new St(t)}enrich(e){let t=m(()=>St.mapping[this.tld],this.tld);return t&&St.validate(`${e}-${t}`)||e}static validate(e){try{let[t]=Intl.DateTimeFormat.supportedLocalesOf(e);return t}catch(t){}}},dn=St;a(dn,"CountryCodeTLDEnricher"),dn.pattern=/\.(\w{2})$/,dn.mapping={uk:"GB",co:"US"};function $u(r){if(!r)return!1;if(r==="is"||r==="is-IS")return!0;try{let[e]=Intl.DateTimeFormat.supportedLocalesOf(r);return!!e}catch(e){}return!1}a($u,"isLocaleValid");var pn=class{constructor(){this.detectors=[new Qi,new Zi]}static detectLocale(e){let[t]=pn.instance.localeOf(e);return t}localeOf(e){return(0,un.array)(this.detectors,(0,Be.flatMap)(t=>t.localeOf(e)),(0,Be.map)(Me),(0,Be.filter)($u),(0,Be.unique)((0,un.by)(Uu)))}},rr=pn;a(rr,"SimpleLocaleDetector"),rr.instance=new pn;var Po;(function(t){t.rate="rate",t.room="room"})(Po||(Po={}));function R(r){return r&&[r.innerText,r.textContent,r.value,r.defaultValue].map(po).find(Boolean)||""}a(R,"innerText");function Hu(r){return rr.detectLocale(r.document)}a(Hu,"getLanguageFromDocument");function So(r){return Hu(r)||r.navigator.language}a(So,"getLanguageFromDocumentOrBrowser");var Bu=/[#:\.]\s*([A-Z0-9]+)/;function Ao(r){if(!r)return;let[,e]=r.match(Bu)||[];return e}a(Ao,"parseReference");var nr=O(Bt()),At=O(vt());function ea(r){return r&&typeof r=="object"?r.constructor===Date&&!isNaN(r.getTime()):!1}a(ea,"isDate");var rt=class{constructor(e,t){this.clock=e;this.daysInThePast=t;this.noYearFactory=nr.InferYear.after(At.Days.startOf(At.Days.subtract(e.now(),t))),this.twoDigitYearFactory=nr.InferYear.sliding(e)}create(e){let{year:t,month:n,day:i}=e;return typeof t=="undefined"?this.noYearFactory.create(e):t<100?this.twoDigitYearFactory.create(e):(0,nr.date)(t,n,i)}static roomsAndRates(e){return new rt(e,3)}static confirmation(e){return new rt(e,28)}};a(rt,"InferCheckinCheckout");function To(r,e){return m(()=>At.Days.between(At.Days.startOf(r),At.Days.startOf(e)))}a(To,"nights");var ra=class{constructor(e,t){this.window=e;this.clock=t;this.factory=rt.roomsAndRates(this.clock)}getDateParser(e){return(0,Oo.parser)(e,{format:"dd MMM yy",factory:this.factory})}getMoneyParser(e,t){let n={strategy:(0,fn.prefer)(t)};return(0,fn.parsers)((0,Ro.flexibleMoneyParser)(e,n),(0,Co.parser)(e,n))}getOccupancy(e){let n=(R(this.window.document.querySelector(".card-widget-resume-home .color-resume-date-b")).match(ra.digitsMatcher)||[]).map(Number),[i,...s]=e===1?n:n.slice(1);return{adults:i,children:s.reduce((o,c)=>o+c,0)}}getDates(e){let t=R(this.window.document.querySelector(".card-widget-resume-home .color-resume-date")),[n,i]=this.getDateParser(e).parseAll(t);return n&&i?{checkin:n,checkout:i}:{}}getRateDetails(e,t){return Array.from(this.window.document.querySelectorAll(".card-rooms-filter")).flatMap(i=>{let s=R(i.querySelector(".card-title"));return m(()=>Array.from(i.querySelectorAll(".bg-rateplan.order-1")),[]).flatMap(c=>{let l=R(c.querySelector(".text-uppercase")),u=R(c).replace("$",""),[v]=this.getMoneyParser(e,t).parseAll(u);return v?[{price:v.amount,currency:v.currency,roomName:s,rateName:l}]:[]})})}getRates(e,t,n){if(n>1)return{ratesModified:void 0,rateDetails:[]};if(Array.from(this.window.document.querySelectorAll("#loader, #loaderSmall")).map(o=>this.window.getComputedStyle(o).display).some(o=>o!=="none"))return{ratesModified:"searchInProgress",rateDetails:[]};let s=this.getRateDetails(e,t);return s.length===0&&this.window.document.querySelector(".card-rooms-filter .fa-phone-alt")?{ratesModified:"noAvailability",rateDetails:s}:{ratesModified:void 0,rateDetails:s}}getLanguageAndCurrency(){let[e,t]=Array.from(this.window.document.querySelectorAll("li.nav-item.dropdown")).map(n=>R(n.querySelector("a"))).filter(n=>n.length===2||n.length===3);return{language:Me(t),currency:e}}integrationData(){let{language:e,currency:t}=this.getLanguageAndCurrency(),n=this.window.document.querySelectorAll("#info-cuarto").length||1,{ratesModified:i,rateDetails:s}=this.getRates(e,t,n),o=i==="searchInProgress"?{}:T(h(h({},this.getDates(e)),this.getOccupancy(n)),{rateDetails:s}),c=m(()=>this.window.document.querySelector("input#promocode").value);return y.removeEmpty(T(h({type:A.RoomsAndRates,language:e},o),{ratesModified:i,total:!0,rooms:n,promoCodes:[c].filter(Boolean)}))}},nt=ra;a(nt,"PalaceResortsRoomsAndRates"),nt.digitsMatcher=/(\d+)/g,fe([ta.cache],nt.prototype,"getDateParser",1),fe([ta.cache],nt.prototype,"getMoneyParser",1);var Gu=["rooms","purchase"];function zu(r,e){return r&&typeof r=="object"&&(e?r.event===e:Gu.includes(r.event))}a(zu,"isEvent");function mn(r,e){let[t={}]=S.safeReverse(r.dataLayer||[]).filter(n=>zu(n,e));return t}a(mn,"getEvent");var Io=O(vt());var Eo=O(di());var yn=class{constructor(e){this.window=e;this.dateParser=(0,Io.parser)("en","yyyy-MM-dd")}integrationData(){if(this.window.location.pathname!=="/confirmation")return;let{startDate:e,endDate:t,orderID:n,rooms:i,languageCode:s}=mn(this.window,"purchase"),o=m(()=>R(this.window.document.body).match(/([A-Z]{3})\$\d+\.\d+/)[1],"USD"),[c,l]=m(()=>[e,t].flatMap(D=>this.dateParser.parseAll(D)),[]),u=this.getReservations(i,o),v=u.map(D=>D.price).reduce(Eo.sum,0);return y.removeEmpty({type:A.Confirmation,language:Me(s),checkin:c,checkout:l,price:v,currency:o,reference:n,reservations:u})}getReservations(e,t){return e.map(n=>({reservationStatus:"confirmed",roomName:n.roomName,roomCode:n.roomCode,adults:n.numberOfAdults,children:n.numberOfTeens+n.numberOfInfants+n.numberOfInfants,currency:t,price:Number(n.roomPrice)}))}};a(yn,"PalaceResortsConfirmation");var ko=O(Vr());var gn=class{static get(){return m(()=>{let e="6216.68895";return e?"v"+e:"latest"})}};a(gn,"Version");var hn=class{constructor(e,t=new ko.SystemClock){this.window=e;this.clock=t}scrape(){return y.removeEmpty({address:m(()=>this.address())})}address(){return{}}app(){return{name:m(()=>this.integrationName().canonical),version:gn.get()}}integrationName(){return m(()=>se(this.window).onboard.integrationName)}};a(hn,"Integration");var Xo=O(Vr());var bn=class{constructor(e){this.rules=e}clean(e){return typeof e=="string"?this.rules.reduce((t,n)=>typeof n=="function"?n(t):t.replace(n.search,n.replace),e):Array.isArray(e)?e.map(re):e&&typeof e=="object"?Object.keys(e).reduce((t,n)=>{let i=e[n];return t[n]=this.clean(i),t},{}):e}};a(bn,"Cleaner");var _o=a(r=>r.trim(),"trim"),Vu={"&amp;":"&","&lt;":"<","&gt;":">","&quot;":'"',"&#x27;":"'","&#x60;":"`","&nbsp;":" "},Wu=a(function(r){let e="(?:"+Object.keys(r).join("|")+")",t=RegExp(e),n=RegExp(e,"g");return function(i){return t.test(i)?i.replace(n,s=>r[s]):i}},"createEscaper"),Mo=Wu(Vu),Ju={search:/{{.*}}/g,replace:""},Yu={search:/[,.\/#!$%^*;:{}\[\]()=_`~®©™'\u201C\u201D\u2018\u2019]+/g,replace:""},No={search:/\s+/g,replace:" "},Xu={search:/\sand\s/gi,replace:" & "},Zu={search:/\s*(?:Image|Logo)\s*/gi,replace:""},Qu={search:/\s*(?:Uniquement\s+Adultes|Adults?\s*(?:Only)\s*)/gi,replace:""},ed={search:/\sAll\sInclusive\s*/gi,replace:""},td={search:/\s*[(\[]?Official\s*(?:Hotel)?\s*(?:((?:Web)?Site)|Homepage|booking\s*engine)\s*(?:for|of)?[)\]]?\s*/gi,replace:""},rd={search:/\s&$/,replace:""},nd=new bn([Ju,Mo,Yu,No,Zu,Qu,ed,td,Xu,rd,co,_o]),jo=new bn([Mo,No,_o]);function re(r){return nd.clean(r)}a(re,"clean");var Bo=O(Bt());var Go=O(ve());var zo=O(rn());var na=class{constructor(e){let t=na.RFC_3986.exec(e);if(!t)throw new Error(`Invalid Uri: ${e}`);let[,,n,,i,s,,o,,c]=t;this.scheme=n,this.authority=i?new vn(i):void 0,this.path=s,this.query=o,this.fragment=c}toString(){let e=[];return typeof this.scheme!="undefined"&&e.push(this.scheme,":"),typeof this.authority!="undefined"&&e.push("//",this.authority.toString()),e.push(this.path),typeof this.query!="undefined"&&e.push("?",this.query),typeof this.fragment!="undefined"&&e.push("#",this.fragment),e.join("")}get host(){return this.authority&&this.authority.host}get port(){return this.authority&&this.authority.port}get userInfo(){return this.authority&&this.authority.userInfo}},B=na;a(B,"Uri"),B.RFC_3986=/^(([^:/?#]+):)?(\/\/([^/?#]*))?([^?#]*)(\?([^#]*))?(#(.*))?/;var ia=class{constructor(e){let t=ia.RFC_3986.exec(e);if(!t)throw new Error(`Invalid Authority: ${e}`);let[,n,i,s]=t;this.userInfo=n,this.host=i,this.port=s}toString(){let e=[];return typeof this.userInfo!="undefined"&&e.push(this.userInfo,"@"),typeof this.host!="undefined"&&e.push(this.host),typeof this.port!="undefined"&&e.push(":",this.port),e.join("")}},vn=ia;a(vn,"Authority"),vn.RFC_3986=/(?:([^@]+)@)?([^:]+)(?::([\d]+))?/;var Lo=te.getProperty("console.log"),id=te.getProperty("console.error"),ad=te.getProperty("console.debug"),aa=class{constructor(e=Lo,t=id,n=ad||Lo){this.log=e;this.error=t;this.debug=n}};a(aa,"ConsoleLogger");var sa=class{constructor(){this.log=a(()=>{},"log");this.error=a(()=>{},"error");this.debug=a(()=>{},"debug")}};a(sa,"NoOpLogger");var qo="triptease-debug",sd=256;function od(r,e=qo){let t=m(()=>{var n;return H((n=r.location)==null?void 0:n.search,!1)[e]})||m(()=>{var n;return H(new B((n=r.location)==null?void 0:n.originalHref).query,!1)[e]})||m(()=>{var n,i;return(i=(n=r.process)==null?void 0:n.env)==null?void 0:i.DEBUG})||m(()=>{var n;return((n=r.localStorage)==null?void 0:n.getItem)&&r.localStorage.getItem(e)})||m(()=>{var n;return((n=r.sessionStorage)==null?void 0:n.getItem)&&r.sessionStorage.getItem(e)})||"";return m(()=>t.substring(0,sd),"")}a(od,"globalParameter");function cd(r){return od(r,qo).split(",").map(e=>e.trim())}a(cd,"debugPatterns");function Fo(r){let e=r.replace(/\./g,"\\.").replace(/\*/g,".*");return new RegExp("^"+e+"$")}a(Fo,"wildcardToRegexp");function ld(r,e=ee){try{let t=cd(e),n=t.filter(i=>i[0]==="!").map(i=>i.substr(1));return n.length>0?!n.some(i=>Fo(i).test(r)):t.some(i=>i==="true"||Fo(i).test(r))}catch(t){return!1}}a(ld,"nameMatches");var oa=class{constructor(e){this.name=e;this.console=new aa}debug(e,...t){this.console.debug(`[${this.name}] ${e}`,...t)}log(e,...t){this.console.log(`[${this.name}] ${e}`,...t)}error(e,...t){this.console.error(`[${this.name}] ${e}`,...t)}};a(oa,"NamedLogger");function I(r,e=ee){return ld(r,e)?new oa(r):new sa}a(I,"namedLogger");var ir=class{static difference(e,t){return Array.from(e).reduce((n,i)=>t.has(i)?n:n.add(i),new Set)}};a(ir,"Sets");var Ge=I("events"),wn=class{constructor(e,t){this.timers=e;this.handle=t;this.finders=new Set;this.keepers=new Set;this.handleEvent=a(e=>g(this,null,function*(){try{Ge.debug("CreatedOrDeletedEvents: Checking for new created items");let t=new Set(Array.from(this.finders).flatMap(s=>s()));Ge.debug("CreatedOrDeletedEvents: found",t);let n=ir.difference(t,this.keepers);Ge.debug("CreatedOrDeletedEvents: newItems",n);let i=ir.difference(this.keepers,t);Ge.debug("CreatedOrDeletedEvents: deletedItems",i),this.keepers=t,(n.size>0||i.size>0)&&(Ge.log(`CreatedOrDeletedEvents: ${n.size} created, ${i.size} deleted element detected - firing event`),yield this.handle(e))}catch(t){Ge.error("CreatedOrDeletedEvents.handleEvent threw while polling",t)}}),"handleEvent")}start(){return g(this,null,function*(){Ge.log("Start polling for created items"),this.id=this.timers.setInterval(this.handleEvent,1e3)})}stop(){return g(this,null,function*(){Ge.log("Stop polling for created items"),this.id&&(this.timers.clearInterval(this.id),this.id=void 0)})}watch(e){e().forEach(n=>this.keepers.add(n)),this.finders.add(e)}};a(wn,"CreatedOrDeletedEvents");function Ko(r,e){return()=>Array.from(r.querySelectorAll(e))}a(Ko,"selectorFinder");var am=te.getProperty("Date");var xn=class{now(){return new Date}};a(xn,"SystemClock");function Uo(r){return new Promise(e=>{this.setTimeout(()=>{e()},r)})}a(Uo,"delay");var ce=class{constructor(e=new xn){this.clock=e;this.delay=Uo.bind(this);this.delay=Uo}task(e){return g(this,null,function*(){return yield this.delay(0),e()})}setTimeout(e,t){return setTimeout(e,t)}clearTimeout(e){clearTimeout(e)}setInterval(e,t){return setInterval(e,t)}clearInterval(e){clearInterval(e)}requestIdleCallback(e,t){let n=t?t.timeout:1,i=this.clock.now().getTime()+n,s=this;return this.setTimeout(()=>{e({didTimeout:!1,timeRemaining(){return Math.max(0,50-(s.clock.now().getTime()-i))}})},n)}cancelIdleCallback(e){this.clearTimeout(e)}};a(ce,"SystemTimers");var lm=new ce;var ud=I("events"),Dn=class{constructor(e,t){this.window=e;this.delegate=t;this.first=!0;this.fire=a(e=>g(this,null,function*(){if(this.window.document.hidden&&!this.first){ud.log("Document hidden - skipping",e);return}yield this.delegate.fire(),this.first=!1}),"fire")}listen(e){return g(this,null,function*(){yield this.delegate.listen(e)})}removeListener(e){this.delegate.removeListener(e)}};a(Dn,"VisibilityGuard");var ca=I("events"),Pn=class{constructor(e,t){this.delegate=e;this.running=t;this.fire=a(e=>g(this,null,function*(){if(this.running.value){ca.log("Already running - skipping",e);return}this.running.value=!0,yield this.delegate.fire(),this.running.value=!1}),"fire")}listen(e){return g(this,null,function*(){if(yield this.delegate.listen(e),this.running.value){ca.log("Already running - firing immediately");try{yield e()}catch(t){ca.log(t)}}})}removeListener(e){this.delegate.removeListener(e)}};a(Pn,"EventsGuard");var $o=I("events"),Sn=class{constructor(){this.handlers=[];this.fire=a(e=>g(this,null,function*(){$o.log(`Firing handlers(${this.handlers.length})`,e),yield Promise.all(this.handlers.map(t=>g(this,null,function*(){try{yield t()}catch(n){$o.log("Error while firing handler",n)}})))}),"fire")}listen(e){return g(this,null,function*(){this.handlers.push(e)})}removeListener(e){this.handlers=this.handlers.filter(t=>t!==e)}};a(Sn,"EventsMultiplexer");var Ho=I("events"),An=class{constructor(e,t){this.timers=e;this.delegate=t;this.timeoutMs=1e3;this.timerId=0;this.fire=a(e=>g(this,null,function*(){Ho.log(`Event observed, waiting for ${this.timeoutMs} ms quiet`,e),this.timers.clearInterval(this.timerId),this.timerId=this.timers.setTimeout(()=>g(this,null,function*(){Ho.log("Event quiet period ended, firing event",e),yield this.delegate(e)}),this.timeoutMs)}),"fire")}};a(An,"EventCollapser");var dd=I("events"),Tn=class{constructor(e,t,n=.2,i=new ce){this.handle=e;this.running=t;this.idleThreshold=n;this.timers=i;this.lastState=!1;this.busy=!1;this.average=new Tt;this.idleHandler=a(e=>{let t=e.timeRemaining();this.running.value?this.busy=!1:t===0?this.busy=!0:(this.average=this.average.calculate(t),this.busy=this.average.percentage<-this.idleThreshold),this.busy?this.idleId=void 0:this.idleId=this.timers.requestIdleCallback(this.idleHandler,t===0?void 0:{timeout:t})},"idleHandler");this.intervalHandler=a(()=>g(this,null,function*(){this.stateHasChanged()&&this.isIdle()&&(dd.log("Browser idle"),yield this.handle("Idle")),this.average=new Tt,this.lastState=this.busy,this.idleId||(this.idleId=this.timers.requestIdleCallback(this.idleHandler))}),"intervalHandler")}start(){return g(this,null,function*(){this.intervalId=this.timers.setInterval(this.intervalHandler,1e3),this.idleId=this.timers.requestIdleCallback(this.idleHandler)})}stop(){return g(this,null,function*(){this.intervalId&&this.timers.clearInterval(this.intervalId),this.idleId&&this.timers.cancelIdleCallback(this.idleId)})}isIdle(){return!this.busy}stateHasChanged(){return this.lastState!==this.busy}};a(Tn,"IdleEvents");var Tt=class{constructor(e=0,t=0,n=0,i=0){this.value=e;this.count=t;this.difference=n;this.percentage=i}calculate(e){let t=this.count+1,n=e-this.value,i=n/this.value,s=this.value+n/t;return new Tt(s,t,n,i)}};a(Tt,"StreamingAverage");var On=class{constructor(e,t){this.window=e;this.handle=t}start(){return g(this,null,function*(){this.window.addEventListener("visibilitychange",this.handle),this.window.addEventListener("popstate",this.handle),this.window.addEventListener("hashchange",this.handle),this.window.addEventListener("pageshow",this.handle),this.window.addEventListener("pagehide",this.handle),this.window.document.readyState!=="complete"?this.window.document.addEventListener("DOMContentLoaded",this.handle):yield this.handle("Document already loaded")})}stop(){return g(this,null,function*(){this.window.removeEventListener("visibilitychange",this.handle),this.window.removeEventListener("popstate",this.handle),this.window.removeEventListener("hashchange",this.handle),this.window.removeEventListener("pageshow",this.handle),this.window.removeEventListener("pagehide",this.handle),this.window.document.removeEventListener("DOMContentLoaded",this.handle)})}};a(On,"WindowEvents");var Cn=class{constructor(){this.value=!1}};a(Cn,"Running");var la=class{constructor(e,t=new ce){this.window=e;let n=new Cn;this.sink=new Dn(e,new Pn(new Sn,n)),this.fire=new An(t,this.sink.fire).fire,this.mutation=new Ot(this.fire),this.created=new wn(t,this.fire),this.sources=[new Tn(this.fire,n),this.mutation,this.created,new On(e,this.fire)]}watch(e){this.created.watch(e)}listen(e){return g(this,null,function*(){yield this.sink.listen(e)})}start(){return g(this,null,function*(){yield Promise.all(this.sources.map(e=>e.start()))})}stop(){return g(this,null,function*(){this.sources.forEach(e=>e.stop())})}removeListener(e){this.sink.removeListener(e)}};a(la,"DefaultEvents");function Rn(r){let e=se(r).triptease;return e.events=e.events||new la(r)}a(Rn,"defaultEvents");var pd={characterData:!0,attributes:!0,childList:!0},Ot=class{constructor(e){this.handle=e;this.observer=new MutationObserver(this.handle)}start(){return g(this,null,function*(){})}stop(){return g(this,null,function*(){this.observer.disconnect()})}static observe(e,t=pd){if(!("MutationObserver"in ee))return e;let n=Rn(ee).mutation;return e instanceof HTMLInputElement||e instanceof HTMLSelectElement?e.addEventListener("change",n.handle):n.observer.observe(e,t),e}};a(Ot,"MutationEvents");function ua(r,e=ee){return m(()=>Rn(e).watch(Ko(e.document,r))),r}a(ua,"watch");var In=class{constructor(e){this.parent=e}querySelector(e,t){let n=this.parent.querySelector(e);return n||void 0}querySelectorAll(e,t){return Array.from(this.parent.querySelectorAll(e))}};a(In,"DomSelectorApi");var Ne=class{constructor(e){this.parent=e}querySelector(e,t){var i;ua(e,(i=this.parent.ownerDocument)==null?void 0:i.defaultView);let n=this.parent.querySelector(e);return n?Ot.observe(n,t):void 0}querySelectorAll(e,t){var n;return ua(e,(n=this.parent.ownerDocument)==null?void 0:n.defaultView),Array.from(this.parent.querySelectorAll(e)).map(i=>Ot.observe(i,t)).filter(Boolean)}};a(Ne,"ObservableSelectorApi");var ar=class{constructor(e,t=new Ne(e.document)){this.window=e;this.selectorApi=t;this.dateParser=(0,Bo.parser)("en","yyyy-MM-dd");this.moneyParser=(0,zo.flexibleMoneyParser)()}getQueryObject(e){return H(e,!1)}getSearchDates(){let{ad:e,dd:t}=this.getQueryObject(this.window.location.search),[n,i]=[e,t].flatMap(s=>this.dateParser.parseAll(s));return{checkin:n,checkout:i}}getOccupancy(){let{a:e,c:t,t:n}=this.getQueryObject(this.window.location.search),i=_e.parse(e),[s]=[_e.parse(t)+_e.parse(n)].filter(_e.isNumber);return{adults:i,children:s}}getRateDetails(){return Array.from(this.window.document.querySelectorAll("#roomMainWrapper .roomWrapper")).filter(t=>this.window.getComputedStyle(t).display!=="none").flatMap(t=>{let n=R(t.querySelector(".roomName span")),s=Array.from(t.querySelectorAll(".roomInfo .roomBody > div[class*=refundable]")).filter(c=>this.window.getComputedStyle(c).display!=="none").flatMap(c=>{let{room:l}=m(()=>c.querySelector(".btnAddRoom").dataset)||{},u=R(c.querySelector("span.refundableTitle")),[,v]=m(()=>c.querySelector(".PricePerNightCollapse").id.split("PricePerNight"))||[],D=R(c.querySelector("span[class*=PriceWithDiscount]")).replace("$",""),[b]=this.moneyParser.parseAll(D);return b?[{price:b.amount,currency:b.currency,roomName:n,roomCode:l,rateName:u,rateCode:v,tags:["member"]}]:[]}),o=this.getPublicRate(t,n);return o&&s.unshift(o),s})}getPublicRate(e,t){let n=e.querySelector(".LblbestOpenMarketPrice"),[,i]=n.id.split("_"),s=R(n),o=R(e.querySelector(".LblPublicRatePrice")),[c]=this.moneyParser.parseAll(o);if(!!c)return y.removeEmpty({roomName:t,roomCode:i,rateName:s,tags:["non-member"],price:c.amount,currency:c.currency})}integrationData(){let e=Ao(R(this.selectorApi.querySelector("#bookingID")));if(!e&&this.isRoomsStepComplete())return;let t=m(()=>Me(this.window.document.querySelector("div[data-lang]").firstChild.textContent)),n=this.getSearchDates(),i=this.getOccupancy(),s=this.getRateDetails();return e?this.asConfirmationData(t,e,n,i,s.filter(o=>o.tags.includes("member"))):y.removeEmpty(T(h(h({type:A.RoomsAndRates,language:t},n),i),{rateDetails:s,rooms:1,total:!0}))}asConfirmationData(e,t,n,i,s){let o=s.length===1?s[0]:{},{price:c,currency:l}=o;return y.removeEmpty(T(h({type:A.Confirmation,language:e,reference:t,price:c,currency:l},n),{reservations:[y.removeEmpty(T(h(h({reservationStatus:"confirmed"},o),i),{tags:void 0}))]}))}isRoomsStepComplete(){return m(()=>this.window.document.querySelector(".custom-progress-bar .li-rooms").classList.contains("is-complete"))}};a(ar,"PalaceResortsElitePage"),fe([Go.cache],ar.prototype,"getQueryObject",1);var da=O(ve()),En=O(Ce()),Vo=O(rn()),Wo=O(tn()),Jo=O(vt());var Yo=O(Ye());var Ct=class{constructor(e){this.window=e;this.dateParser=(0,Jo.parser)("en-GB","yyyy-MM-dd")}getMoneyParser(e,t){let n={strategy:(0,En.prefer)(t)};return(0,En.parsers)((0,Vo.flexibleMoneyParser)(e,n),(0,Wo.parser)(e,n))}getQueryObject(e){return H(e,!1)}getDates(){let{"skd-checkin":e,"skd-checkout":t}=this.getQueryObject(this.window.location.search),[n,i]=[e,t].flatMap(s=>this.dateParser.parseAll(s));return{checkin:n,checkout:i}}getOccupancy(){let[e]=R(this.window.document.querySelector(".bg-room-active .text-title-room")).match(/\d+/g)||[],t=_e.parse(e),{adults:n,teens:i=0,kids:s=0,infants:o=0}=(0,Yo.get)(()=>JSON.parse(this.window.sessionStorage.getItem("My-Reservation")).pax[t-1],{});return{adults:n,children:i+s+o}}getRateDetails(e,t){let n=this.getMoneyParser(e,t);return Array.from(this.window.document.querySelectorAll(".card-rooms")).flatMap(s=>{let o=R(s.querySelector(".card-title"));return Array.from(s.querySelectorAll(".plan-name-rooms")).map(l=>l.parentElement).flatMap(l=>{let u=R(l.querySelector(".plan-name-rooms")),v=R(l.querySelector(".offer-price")),[D]=n.parseAll(v);return D?[y.removeEmpty({price:D.amount,currency:D.currency,rateName:u,roomName:o})]:[]})})}getRatesModified(e){if(e===0&&R(this.window.document.querySelector(".content-not-available")).toLowerCase().includes("fully booked"))return"noAvailability"}integrationData(){if(Array.from(this.window.document.querySelectorAll("#loader, #loaderSmall")).map(s=>this.window.getComputedStyle(s).display).some(s=>s!=="none"))return;let t=Me(R(this.window.document.querySelector(".title-language"))),n=R(this.window.document.querySelector(".my_currency")),i=this.getRateDetails(t,n);return y.removeEmpty(T(h(h({type:A.RoomsAndRates,language:t},this.getDates()),this.getOccupancy()),{rooms:1,total:!1,rateDetails:i,ratesModified:this.getRatesModified(i.length)}))}};a(Ct,"PalaceResortsRoomsAndRates2"),fe([da.cache],Ct.prototype,"getMoneyParser",1),fe([da.cache],Ct.prototype,"getQueryObject",1);var kn=class extends hn{constructor(){super(...arguments);this.pages=[new yn(this.window),new nt(this.window,new Xo.SystemClock),new Ct(this.window),new ar(this.window)]}scrape(){let e=this.window.document.querySelector("#options-hotel div"),t=this.window.document.querySelector("h1 #accommodationsHotel"),{hotelName:n,propertyCode:i}=mn(this.window),{r:s}=H(this.window.location.search,!1);return y.removeEmpty({identifiers:[{identifier:i,identifierType:"HotelCode",type:"Untrusted",source:"dataLayer"},{identifier:re(n),identifierType:"HotelName",type:"Untrusted",source:"dataLayer"},{identifier:m(()=>e.dataset.value),identifierType:"HotelCode",type:"Untrusted",source:"div"},{identifier:re(R(e)),identifierType:"HotelName",type:"Untrusted",source:"div"},{identifier:s,identifierType:"HotelCode",type:"Untrusted",source:"url"},{identifier:re(R(t)),identifierType:"HotelName",type:"Untrusted",source:"h1"}].filter(o=>o.identifier)})}};a(kn,"PalaceResorts");function Zo(r){if(r===void 0||!r.type)return!1;switch(r.type){case A.RoomsAndRates:return pa(r);case A.Confirmation:return fa(r);default:return!0}}a(Zo,"isPageValid");function fd(r){return Array.isArray(r)&&r.some(e=>e.price>0&&e.currency)}a(fd,"hasValidRates");function pa(r){return r&&typeof r=="object"?ea(r.checkin)&&ea(r.checkout)&&r.checkin.getTime()<r.checkout.getTime()&&typeof r.adults=="number"&&typeof r.children=="number"&&(fd(r.rateDetails)||!!r.ratesModified):!1}a(pa,"isRoomsAndRatesPageData");function fa(r){return r&&typeof r=="object"?typeof r.reference=="string"&&!F.isEmpty(r.reference)&&typeof r.price=="number"&&typeof r.currency=="string":!1}a(fa,"isConfirmationPageData");function md(r){if(r===void 0||!r.type)return!1;switch(r.type){case A.RoomsAndRates:return sr(r);case A.Confirmation:return yd(r);default:return!1}}a(md,"isPartialPage");function sr(r){return r&&typeof r=="object"?Array.isArray(r.rateDetails)&&r.rateDetails.length>0||!!r.ratesModified:!1}a(sr,"isPartialRoomsAndRates");function yd(r){return r&&typeof r=="object"?typeof r.reference=="string"&&!F.isEmpty(r.reference):!1}a(yd,"isPartialConfirmation");function Qo(r){let[e]=r.map(y.removeEmpty).filter(md);if(!!e)return T(h({},e),{type:A.Partial,partialType:e.type})}a(Qo,"findPartial");function ma(r){let{rateDetails:e}=r;if(!e)return[];let t=e.filter(n=>n.price>0&&!F.isEmpty(n.currency));return S.unique(t.map(n=>n.currency)).length>1?[]:t}a(ma,"validRates");function gd(r){try{let{target:e,method:t}=vd(r.type);if(e&&t)return!0}catch(e){}return!1}a(gd,"isOnboardMessage");var or=class{constructor(e,t,n=hd,i=I("messaging")){this.listener=e;this.target=t;this.allowedOrigins=n;this.logger=i}addListener(e){this.listener&&this.listener.addEventListener("message",t=>{this.disallowedOrigin(t)||!gd(t.data)||e(t.data,new or(void 0,t.source||this.target))})}disallowedOrigin(e){return e.origin&&this.allowedOrigins.length>0&&this.allowedOrigins.indexOf(new B(e.origin).host)===-1}send(e){if(this.target)try{this.target.postMessage(e,"*")}catch(t){this.target.postMessage(JSON.parse(JSON.stringify(e)),"*")}}};a(or,"WindowHandler");var hd=["onboard.triptease.io","localhost"],bd=/^(.*)\.([^.]+)$/;function vd(r){let[,e,t]=r.match(bd)||[];return{target:e,method:t}}a(vd,"targetAndMethod");function ya(r){let e={};return function(...t){let n=JSON.stringify(t),i=e[n];return typeof i!="undefined"?i:e[n]=r(...t)}}a(ya,"caching");function wd(r){return r.document.querySelector('iframe[name="triptease.onboard.kernel"]')}a(wd,"kernelFrame");function ec(r){let e=wd(r);if(e&&e.contentWindow)return new or(r,e.contentWindow)}a(ec,"handlerFor");function tc(r){return r&&typeof r=="object"&&"name"in r&&typeof r.name=="string"&&"message"in r&&typeof r.message=="string"&&"stack"in r&&typeof r.stack=="string"}a(tc,"isError");var _n,xd=new Uint8Array(16);function ga(){if(!_n&&(_n=typeof crypto!="undefined"&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto)||typeof msCrypto!="undefined"&&typeof msCrypto.getRandomValues=="function"&&msCrypto.getRandomValues.bind(msCrypto),!_n))throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return _n(xd)}a(ga,"rng");var rc=/^(?:[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}|00000000-0000-0000-0000-000000000000)$/i;function Dd(r){return typeof r=="string"&&rc.test(r)}a(Dd,"validate");var nc=Dd;var G=[];for(Mn=0;Mn<256;++Mn)G.push((Mn+256).toString(16).substr(1));var Mn;function Pd(r){var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,t=(G[r[e+0]]+G[r[e+1]]+G[r[e+2]]+G[r[e+3]]+"-"+G[r[e+4]]+G[r[e+5]]+"-"+G[r[e+6]]+G[r[e+7]]+"-"+G[r[e+8]]+G[r[e+9]]+"-"+G[r[e+10]]+G[r[e+11]]+G[r[e+12]]+G[r[e+13]]+G[r[e+14]]+G[r[e+15]]).toLowerCase();if(!nc(t))throw TypeError("Stringified UUID is invalid");return t}a(Pd,"stringify");var ic=Pd;function Sd(r,e,t){r=r||{};var n=r.random||(r.rng||ga)();if(n[6]=n[6]&15|64,n[8]=n[8]&63|128,e){t=t||0;for(var i=0;i<16;++i)e[t+i]=n[i];return e}return ic(n)}a(Sd,"v4");var ha=Sd;var Ad=a(()=>m(()=>crypto.randomUUID())||ha(),"uuid"),Nn=class{generate(e){if(typeof e!="undefined")throw new Error("UuidGenerator does not support custom lengths");return Ad().replace(/-/g,"")}};a(Nn,"UUIDGenerator");var ba=class{constructor(e,t){this.messaging=e;this.idGenerator=t}get(e,t,n){return(...i)=>g(this,null,function*(){let s=this.idGenerator.generate(),{payload:o}=yield this.messaging.handle({type:"triptease.onboard.request",requestType:String(t),payload:i,correlationId:s});if(tc(o))throw o;return o})}};a(ba,"MessageProxy");function jn(r,e=new Nn){return new Proxy({},new ba(r,e))}a(jn,"messageProxy");var Ln=class{constructor(e,t=jn(e)){this.proxy=t;this.applicationConfig=ya(e=>g(this,null,function*(){return yield this.proxy.applicationConfig(e)}));this.generateConfig=ya(e=>g(this,null,function*(){return yield this.proxy.generateConfig(e)}))}};a(Ln,"KernelProxy");var qn=class{constructor(e,t){this.providers=e;this.logger=t}scrape(){return g(this,null,function*(){return(yield Promise.all(this.providers.map(t=>g(this,null,function*(){try{return this.clean(yield t.scrape())}catch(n){return this.logger.error("Scraper threw error, probable identification failure",n),{}}})))).reduce((t,n)=>h(h({},t),n),{})})}clean(e){let t=y.removeEmpty(e);return t.identifiers&&(t.identifiers=t.identifiers.filter(n=>!!n.identifier).map(n=>y.removeEmpty({identifier:n.identifier.toString().trim(),type:n.type,identifierType:n.identifierType,source:n.source})).filter(n=>!F.isEmpty(n.identifier))),t}};a(qn,"CompositeScraper");function cr(r){if(F.isEmpty(r))return{};if(r.indexOf(":")!==-1){let[e,t]=r.split(":");return{clientKey:e,identifiers:[{identifier:t,type:"Trusted",identifierType:"HotelCode"}]}}return{apiKey:r}}a(cr,"processApiKey");function Fn(r){if(!Pt(r))return{};let{integrationId:e,clientKey:t,apiKey:n,identifiers:i,type:s}=r,o=cr(n);return e&&(o.integrationId=e),t&&(o.clientKey=t),i&&(o.identifiers=i),s&&(o.type=s),o}a(Fn,"processIdentifiers");var Rt=class{constructor(){this.scripts=[]}static create(e){let t=se(e).onboard,n=t.stackScriptFinder;return n||(t.stackScriptFinder=new Rt)}capture(){let e=Od();!e||this.scripts.push(e)}get(){return this.scripts}};a(Rt,"StackScriptFinder");var Td=/(https?.*):\d+:\d+/;function Od(){try{throw new Error}catch(r){if(!r.stack)return;let e=r.stack.match(Td);if(!e)return;let t=e[1];return new B(t)}}a(Od,"scriptUri");var It=class{static find(e){return this.scripts(e).map(t=>new B(t.src))}static scripts(e){let n=["bootstrap.js","/paperboy/","/identity-service/confirm"].map(s=>`script[src*="${s}"][src*="triptease.io"]`);n.push('script[src*="triptease.net"]');let i=n.join(", ");return e.querySelectorAll(i)}};a(It,"ScriptsFinder");var ze=class{constructor(e){this.window=e}scrape(){let e=It.find(new In(this.window.document)),t=Rt.create(this.window).get();return ze.extract([...e,...t])}static extract(e){return y.removeEmpty(e.reduce((t,n)=>{let i=t.integrationId?[t.integrationId]:[],s=t.clientKey?[t.clientKey]:[],o=t.apiKey?[t.apiKey]:[],c=t.identifiers?t.identifiers:[],l=H(n.query,!1),u=ze.pathClientKey(n);u&&s.unshift(u),l.clientKey&&s.unshift(l.clientKey),i.unshift(l.integrationId);let v=ze.queryApiKey(l),D=cr(v);D.apiKey&&o.unshift(D.apiKey),D.clientKey&&s.unshift(D.clientKey),D.identifiers&&c.unshift(D.identifiers[0]);let[b]=i.filter(Boolean),[V]=s.filter(Boolean),[je]=o.filter(Boolean),q=c.filter(Boolean);return{integrationId:b,clientKey:V,apiKey:je,identifiers:q}},{}))}static queryApiKey(e){return e.apiKey||e.hotelkey||e.hotelKey||e["api-key"]||e.token}static pathClientKey(e){if(e.host==="paperboy.triptease.net"){let[,n]=e.path.match(/\/+([^/.]+)(?:\.js)?$/)||[];return n}let[,t=""]=e.path.match(/\/paperboy\/+([^/.]+)(?:\.js)?$/)||[];if(t!="paperboy"&&t!="confirm")return t}};a(ze,"ScriptScraper");function ac(r,e){if(e){let t=m(()=>r.tt_apiKeys[e])||m(()=>r.ttApiKeys[e])||m(()=>r.document.apiKeys[e])||m(()=>r.document.ttApiKeys[e]);if(t)return va(t)}return va(m(()=>r.ttData.apiKey)||r.ttApiKey||r.document.ttApiKey)}a(ac,"getApiKey");function sc(r){return va(r.tt_clientKey||r.document.ttClientKey||r.document.tt_clientKey)}a(sc,"getClientKey");var Cd=["CLIENT_KEY","API_KEY"];function va(r){if(!!r&&!Cd.includes(r))return r}a(va,"cleanKey");var Kn=class{constructor(e){this.window=e}scrape(){let e=ac(this.window),t=cr(e);return y.removeEmpty(T(h({},t),{clientKey:sc(this.window)}))}};a(Kn,"LegacyScraper");var Un=class{constructor(e){this.pageData=e}scrape(){return Fn(this.pageData)}};a(Un,"PageScraper");var Vn=O(z());var Rd=I("integration-executor"),$n=class{process(e){let t=T(h({},e),{basePrice:oc(e.price,e.basePrice),reservationStatus:Ed(e)});return t.reservations=kd(t),t.basePrice=t.basePrice||cc("basePrice",t.reservations),y.removeEmpty(t)}};a($n,"ConfirmationProcessor");function Id(r,e){return e?r?r>e:!0:!1}a(Id,"isBasePriceValid");function oc(r,e){return Id(r,e)?e:void 0}a(oc,"validatedBasePrice");function Ed(r){let{reservationStatus:e,reservations:t}=r;if(e)return e;if(!t)return"confirmed";let n=new Set(t.map(i=>i.reservationStatus));return n.size===1?Array.from(n)[0]:n.has("pending")?"pending":"modified"}a(Ed,"calculateReservationStatus");function kd(r){let{reference:e,price:t,currency:n,basePrice:i,reservationStatus:s}=r;if(!r.reservations)return[y.removeEmpty({reference:e,price:t,currency:n,basePrice:i,reservationStatus:s})];let o=r.reservations.map(l=>y.removeEmpty(T(h({},l),{basePrice:oc(l.price,l.basePrice)}))),c=cc("basePrice",o);return c!==void 0&&c===t?_d("basePrice","price",o):o}a(kd,"calculateReservations");function cc(r,e){if(e.every(t=>t[r]))return e.reduce((t,n)=>n.reservationStatus==="confirmed"?t+n[r]:t,0)}a(cc,"sumOf");function _d(r,e,t){return t.every(n=>!n[e])?(Rd.log(`Changing label from ${r} to ${e} in reservations`),t.map(n=>y.removeEmpty(T(h({},n),{[e]:n[r],[r]:void 0})))):t}a(_d,"changeLabel");var uc=O(z()),Hn=O(me());var lr;(function(n){n.Unknown="Unknown",n.Total="Total",n.Nightly="Nightly"})(lr||(lr={}));function lc(r){return r===!0?lr.Total:r===!1?lr.Nightly:lr.Unknown}a(lc,"asPriceType");var Md=I("integration-executor"),Bn=class{constructor(e,t){this.window=e;this.history=t}process(e){let t=y.removeEmpty(T(h({},e),{type:A.RoomsAndRates}));return t.rateDetails=ma(e),t.ratesModified=this.calculateRatesModified(t),t.priceType=lc(t.total),t}calculateRatesModified(e){let{ratesModified:t,promoCodes:n}=e;return t||(this.hasSearchChangedWithoutRatesChanging(e)||this.hasCurrencyChangedWithoutPricesChanging(e)?"untrusted":this.hasRatesChangedWithoutSearchChanging(e)?"roomOrRateFiltered":n&&n.length>0?"discountCode":"none")}hasCurrencyChangedWithoutPricesChanging(e){let t=this.history.find(i=>sr(i));return!((t==null?void 0:t.rateDetails)&&(e==null?void 0:e.rateDetails)&&t.rateDetails.length===e.rateDetails.length&&e.rateDetails.length>0)||!!M.same(dc(e.rateDetails,"currency"),dc(t.rateDetails,"currency"))?!1:M.same(wa(e.rateDetails,"currency"),wa(t.rateDetails,"currency"))}hasSearchChangedWithoutRatesChanging(e){let t=this.history.find(n=>sr(n));if(!t)return!1;if(!M.same(Gn(e),Gn(t)))return M.same(zn(e.rateDetails),zn(t.rateDetails))}hasRatesChangedWithoutSearchChanging(e){let t=this.history.find(o=>sr(o));if(!t||!M.same(Gn(e),Gn(t)))return!1;let{rateDetails:n,ratesModified:i}=t;if(i==="roomOrRateFiltered")return!0;if(i==="searchInProgress"||i==="untrusted")return!1;let{rateDetails:s}=e;return!(ma(t).length===0&&s&&s.length>0||M.isSuperset(zn(n),zn(s))||Nd(n,s))}};a(Bn,"RoomsAndRatesProcessor");function Gn(r){let{apiKey:e,checkin:t,checkout:n,rooms:i,adults:s,children:o,total:c}=r;return y.removeEmpty({apiKey:e,checkin:t,checkout:n,rooms:i,adults:s,children:o,total:c})}a(Gn,"searchParameters");function zn(r){return wa(r,"rateName","roomName","rateCode","roomCode")}a(zn,"excludeNames");function wa(r,...e){if(!r)return;let t=e.reduce((n,i)=>(n[i]=void 0,n),{});return r.map(n=>y.removeEmpty(h(h({},n),t)))}a(wa,"excludeKeys");function dc(r,...e){if(!!r)return r.map(t=>y.removeEmpty(e.reduce((n,i)=>(n[i]=t[i],n),{})))}a(dc,"pickKeys");function Nd(r,e){if(r.length===0||e.length===0||r.length!==e.length||r[0].currency===e[0].currency)return!1;let t=(0,uc.array)(r.map(o=>o.price),(0,Hn.zip)(e.map(o=>o.price)),(0,Hn.map)(([o,c])=>c/o)),n=Math.min(...t),i=Math.max(...t),s=(i-n)/i;return Md.debug(`Currency changed percentDifference ${s}`),s<.01}a(Nd,"currencyChanged");var Wn=class{constructor(e,t,n=new Bn(e,t),i=new $n){this.window=e;this.history=t;this.roomsAndRatesProcessor=n;this.confirmationProcessor=i}process(e){return this.additionalProcessing((()=>{switch(e.type){case A.RoomsAndRates:return this.roomsAndRatesProcessor.process(e);case A.Confirmation:return this.addDatesFromSearch(this.confirmationProcessor.process(e));default:return e}})())}additionalProcessing(e){let t=h({},e);fo(e)&&(t.nights=To(e.checkout,e.checkin)),"rateDetails"in e&&e.rateDetails.length>0&&(t.rateSummary=jd(e.rateDetails));let n=Ld(e.promoCodes);return n&&(t.promoCodes=n),t}addDatesFromSearch(e){let{checkin:t,checkout:n}=e;if(t&&n)return e;let i=this.history.find(s=>s.type===A.RoomsAndRates);return y.removeEmpty(T(h({},e),{checkin:m(()=>i.checkin),checkout:m(()=>i.checkout)}))}};a(Wn,"IntegrationDataProcessor");function jd(r){if(!r||r.length===0)return;let e=[...r].sort((0,Vn.by)("price",Vn.ascending)),[t]=e;return{count:r.length,currency:t.currency,min:t,max:S.last(e)}}a(jd,"rateSummary");function Ld(r){if(!r)return;let e=new Set(["undefined","null"]);return r.map(t=>t==null?void 0:t.trim()).filter(Boolean).filter(t=>!e.has(t))}a(Ld,"validCodes");function xa(r){if(r.hasOwnProperty("parentElement"))return r.parentElement;let e=r.parentNode;return e instanceof Element?e:e?xa(e):null}a(xa,"parentOf");var qd=/^\s*$/,Fd=a(r=>r instanceof Text&&qd.test(r.data),"isWhiteSpace"),Kd=["script","style","noscript","a"].map(r=>r.toUpperCase()),Ud=a(r=>r&&Kd.indexOf(r.tagName)!==-1,"isUninterestingTag"),$d=a(r=>!Fd(r)&&!Ud(xa(r)),"isValid");function Jn(r){return r instanceof Element?r:xa(r)}a(Jn,"elementOf");function Hd(r){let e=Jn(r);if(!!e)return e.getBoundingClientRect()}a(Hd,"clientRectOf");function Bd(r,e){let t=e.documentElement.scrollWidth,n=e.documentElement.scrollHeight,i=e.documentElement.scrollLeft,s=e.documentElement.scrollTop;if(t==0||n==0)return;let o=Hd(r);if(!!o)return{x:(o.left+i)/t,y:(o.top+s)/n,width:o.width/t,height:o.height/n}}a(Bd,"positionOf");function Gd(r){if(r instanceof Text)return r.data.trim();if(r instanceof Element)return r.getAttribute("aria-label")||r.getAttribute("title")||r.getAttribute("alt")||void 0}a(Gd,"valueOf");function zd(r,e=.8){return r.y<e&&r.width>0&&r.height>0}a(zd,"isVisibleDefault");function pc(r,e=zd){let t=r.document,n=[],i=t.createNodeIterator(t.documentElement,NodeFilter.SHOW_TEXT,null);for(;;){let c=i.nextNode();if(!c)break;$d(c)&&n.push(c)}let s=t.querySelectorAll("[aria-label], img[title], img[alt]");for(let c=0;c<s.length;c++)n.push(s[c]);n.sort((c,l)=>{let u=Jn(c).compareDocumentPosition(Jn(l));return u&Node.DOCUMENT_POSITION_PRECEDING?1:u&Node.DOCUMENT_POSITION_FOLLOWING?-1:0});let o=[];for(let c=0;c<n.length;c++){let l=n[c],u=Bd(l,t);if(u&&!e(u))continue;let v=Gd(l);typeof v=="string"&&v.split(/[\r\n]/).forEach(D=>{if(D.length>2&&D.length<93){let b=Jn(l);o.push({source:b?b.tagName.toLowerCase():"",type:"Untrusted",identifierType:"Unknown",identifier:re(D)})}})}return o}a(pc,"getDocumentIdentifierSources");var Vd=["context.hotelName","Cart.HName","propertyName","ihReservations.ihHotelName","ihHotelName","HName","transactionHotelName","ratequeryHotelName","hpr","strippedPropertyName","property_name","flipto.sessionData.propertyName","HotelName"];function Wd(r){return m(()=>r.event.indexOf("gtm.")===0,!1)}a(Wd,"isGtmEvent");function fc(r){let e=Array.isArray(r)?r:r.dataLayer||[],t=S.safeReverse(e).filter(n=>!Wd(n));return Vd.flatMap(n=>S.clean(S.unique(sn(t,...n.split(".")))).map(i=>({source:"dataLayer."+n,identifier:re(i),type:"Trusted",identifierType:"HotelName"})))}a(fc,"dataLayerIdentifiers");var Yn=class{constructor(e,t,n){this.scope=e;this.property=t;this.seed=n}parentScope(e){let[,...t]=nn.path(e);return S.find(t,n=>n.hasAttribute(this.scope))}getValue(e){return e.hasAttribute(this.scope)?this.processScope(e):e.getAttribute("content")||e.getAttribute("src")||e.getAttribute("href")||e.getAttribute("data")||e.getAttribute("value")||e.getAttribute("datetime")||e.textContent}processScope(e){return S.from(e.querySelectorAll(`*[${this.property}]`)).filter(t=>this.parentScope(t)===e).reduce((t,n)=>{let i=n.getAttribute(this.property);return i?on(t,i,jo.clean(this.getValue(n))):t},this.seed(e))}processDocument(e){return new Ne(e).querySelectorAll(`*[${this.scope}]`).map(this.processScope.bind(this))}};a(Yn,"StructuredDataExtractor");var Jd=new Yn("itemscope","itemprop",r=>{let t=(r.getAttribute("itemtype")||"Unknown").split("/");return Xn("microdata",{"@type":t.pop(),"@context":t.join("/")})}),Yd=new Yn("typeof","property",r=>Xn("rdfa",{"@type":r.getAttribute("typeof"),"@context":r.getAttribute("vocab")})),Xd={processDocument(r){return S.flatten(new Ne(r).querySelectorAll('script[type="application/ld+json"]').map(e=>{let n=(e.textContent||"").replace(/[\r\n]/g," ");try{let i=oe.parse(n),s=i["@graph"]||i;return Array.isArray(s)?s.map(o=>Xn("json-ld",o)):Xn("json-ld",i)}catch(i){return{"@type":"Error",error:i.toString(),json:n}}}))}};function Xn(r,e){return T(h({},e),{"@format":r})}a(Xn,"addFormat");var mc={processDocument(r){return[...Xd.processDocument(r),...Jd.processDocument(r),...Yd.processDocument(r)]}};function yc(r,e){let t=mc.processDocument(r).filter(n=>Qd.indexOf(n["@type"])!==-1);return[...new Zn(Da,"Trusted",e).from(t),...new Zn(gc,"Untrusted",e).from(t)].filter(n=>typeof n.identifier!="object")}a(yc,"structuredDataIdentifiers");var Zn=class{constructor(e,t,n=!0){this.orderedStructuredDataTypes=e;this.type=t;this.appendBrand=n}from(e){return S.flatten(this.filterStructuredData(e).map(t=>{let n=(Array.isArray(t.name)?t.name:[t.name]).flatMap(s=>({source:`structuredData[@type='${t["@type"]}'].name`,identifier:re(this.addBrand(t.brand,s)),type:this.type,identifierType:ep(t["@type"])})),i=t.identifier;return i&&n.push({type:this.type,identifier:i,source:`structuredData[@type='${t["@type"]}'].identifier`,identifierType:"HotelCode"}),n}))}addBrand(e,t){return!this.appendBrand||!e||t.indexOf(e)>=0?t:`${e} ${t}`}filterStructuredData(e){return e?e.filter(t=>this.orderedStructuredDataTypes.indexOf(t["@type"])>=0).filter(t=>Boolean(t.name)).sort((t,n)=>this.orderedStructuredDataTypes.indexOf(t["@type"])-this.orderedStructuredDataTypes.indexOf(n["@type"])):[]}};a(Zn,"StructuredDataSources");var Da=["Hotel","LodgingBusiness","BedAndBreakfast"],gc=["WebSite","LocalBusiness","Organization"],Zd=["HotelRoom","LodgingReservation","Offer"],Qd=[...Da,...gc,...Zd];function ep(r){return Da.includes(r)?"HotelName":"Unknown"}a(ep,"inferIdentifierTypeFrom");function tp(r){return r.identifier&&r.identifier.length>2&&r.identifier.length<110}a(tp,"hasSensibleData");var Qn=class{constructor(e,t=I("hotel-identifiers-scraper")){this.window=e;this.logger=t}scrape(){return{identifiers:this.identifierSources()}}identifierSources(){let e=[...fc(this.window),...yc(this.window.document),...sp(this.window.document),...cp(this.window.document),...rp(this.window),...np(this.window.document),...ap(this.window)].filter(tp);if(this.logger.log("Common identifiers",e),e.find(t=>cn.has(t.identifierType)))return e;{let t=pc(this.window);return this.logger.log("Additional identifiers",t),[...e,...t]}}};a(Qn,"HotelIdentifiersScraper");function ur(r){return r?Pt(r)?!!r.apiKey||!!r.identifiers&&r.identifiers.length>0:Array.isArray(r)?r.reduce((e,t)=>e||ur(t),!1):r.constructor===Object?ur(y.values(r)):!1:!1}a(ur,"hasApiKeyOrIdentifier");function rp(r){if(r===void 0)return[];let{scheme:e,host:t,path:n,query:i}=m(()=>r instanceof B?r:typeof r=="string"?new B(r):new B(r.location.href),{});if(e==="about")return[];let s=[t,n].filter(Boolean).flatMap(c=>c==null?void 0:c.split(/[./]/g)),o=Object.values(H(i,!1));return[...s,...o].filter(c=>c&&c.length>3).map(c=>({identifier:c,type:"Untrusted",source:"url",identifierType:"PossibleIdentifier"}))}a(rp,"urlIdentifiers");function np(r){let{HotelCode:e}=ip(r);return[{identifierType:"PossibleIdentifier",type:"Untrusted",identifier:e,source:"cookie"}]}a(np,"cookieIdentifiers");function ip(r){return m(()=>r.cookie.split(";").reduce((e,t)=>{let[n,i]=t.trim().split("=").map(decodeURIComponent);return e[n]=i,e},{}),{})}a(ip,"cookieObject");function ap(r){let e=r.explicitHotelIdentifier;return[{identifierType:"PossibleIdentifier",type:"Untrusted",identifier:e,source:"window"}]}a(ap,"miscIdentifiers");function sp(r){return r.title.split(/[|\-:]/).reverse().map(e=>({source:"title",identifier:re(e),type:"Untrusted",identifierType:"Unknown"}))}a(sp,"titles");function op(r){return Array.from(r.getElementsByTagName("meta")).reduce((e,t)=>{let n=t.getAttribute("name")||t.getAttribute("property")||t.getAttribute("http-equiv"),i=t.getAttribute("content");return n&&(e[n]=i),e},{})}a(op,"metaObject");function cp(r){let e=["site-id","og:title","og:site_name","twitter:title"],t=op(r);return Object.keys(t).filter(n=>e.indexOf(n)!=-1).map(n=>({source:`meta.${n}`,identifier:re(t[n]),type:"Untrusted",identifierType:"Unknown"}))}a(cp,"metaLabels");var ei=class{constructor(e){this.storage=e}get(e){let t=this.storage.getItem(e);if(t)return oe.parseWithDates(t)}set(e,t){return this.storage.setItem(e,JSON.stringify(t)),this}clear(){this.storage.clear()}};a(ei,"JsonStorage");var ti=class{constructor(){this.data=new Map}get(e){return this.data.get(e)}set(e,t){return this.data.set(e,t)}clear(){this.data.clear()}};a(ti,"InMemoryTypedStorage");var ri=class{constructor(e){this.stores=e}clear(){this.stores.forEach(e=>m(()=>e.clear()))}get(e){for(let t of this.stores){let n=m(()=>t.get(e));if(n)return n}}set(e,t){return this.stores.forEach(n=>m(()=>n.set(e,t))),this}};a(ri,"CompositeTypedStorage");var kt=class{constructor(e){this.storage=e}static create(e){return new kt(new ri([m(()=>new ei(e.sessionStorage)),kt.backupStorage]))}add(e){let t=this.data();return t.unshift(e),this.storage.set(kt.previousPages,lo(t,10)),e}last(){let[e]=this.data();return e}data(){return this.storage.get(kt.previousPages)||[{type:A.Unknown}]}find(e){return S.find(this.data(),e)}clear(){this.storage.clear()}},Et=kt;a(Et,"IntegrationHistory"),Et.previousPages="triptease.integration.previous-pages",Et.backupStorage=new ti;var Pa=class{reset(){}summarise(){return{}}timeAsync(e,t){return t()}timeCall(e,t){return t}timeSync(e,t){return t()}};a(Pa,"StubReporter");function hc(){return typeof performance=="object"&&"now"in performance?new Sa:new Pa}a(hc,"createReporter");var Sa=class{constructor(e=[],t=new ce){this.timings=e;this.timers=t}timeCall(e,t){let n=this;return function(...i){let s=performance.now(),o=t.apply(this,i),c=performance.now()-s;return n.timings.push({name:e,time:c}),o}}timeSync(e,t){let n=performance.now(),i=t(),s=performance.now()-n;return this.timings.push({name:e,time:s}),i}timeAsync(e,t){return g(this,null,function*(){let n=performance.now(),i=yield this.timers.task(t),s=performance.now()-n;return this.timings.push({name:e,time:s}),i})}summarise(){let e=this.timings.reduce((t,{name:n,time:i})=>{let s=t[n]||{count:0,avg:0,sum:0,min:Number.MAX_VALUE,max:Number.MIN_VALUE};return s.count++,s.min=Math.min(s.min,i),s.max=Math.max(s.max,i),s.sum+=i,s.avg+=(i-s.avg)/s.count,t[n]=s,t},{});return this.reset(),e}reset(){this.timings.length=0}};a(Sa,"RealReporter");var bc="triptease.onboard.response";function vc(r){return r&&typeof r=="object"&&r.type==="triptease.onboard.response"&&typeof r.correlationId=="string"}a(vc,"isOnboardResponse");var wc=I("messaging"),ni=class{constructor(e){this.messageHandler=e;this.promises=new Map;e&&e.addListener(t=>{if(vc(t)){let{correlationId:n}=t,i=this.promises.get(n);i&&(wc.debug("Sender matched response",t),i.resolve(t),this.promises.delete(n))}})}handle(e){return g(this,null,function*(){return wc.debug("Sending request",e),this.messageHandler&&this.messageHandler.send(e),new Promise((t,n)=>{this.promises.set(e.correlationId,{resolve:t,reject:n})})})}};a(ni,"Sender");function xc(r){return y.removeEmpty(T(h({},r),{lines:m(()=>r.lines.filter(Boolean).map(String))}))}a(xc,"cleanAddress");function lp(r){return r&&typeof r=="function"&&typeof r.getAll=="function"}a(lp,"isGoogleAnalytics");function Dc(n,i){return g(this,arguments,function*(r,e,t=new ce){let s=r[r.GoogleAnalyticsObject||"ga"];return lp(s)?an(()=>g(this,null,function*(){let o=new Promise(c=>s(()=>c(S.unique(s.getAll().map(l=>l.get(e))))));return yield Promise.race([o,t.delay(50).then(()=>[])])})):[]})}a(Dc,"googleAnalytics");function up(r){return S.unique(Array.from(r.document.querySelectorAll("script[src*=googletagmanager]")).map(e=>{let{query:t}=new B(e.src),{id:n}=H(t);return n}))}a(up,"googleTagManager");function Pc(r){return g(this,null,function*(){return{ga:yield Dc(r,"trackingId"),ga_ci:yield Dc(r,"clientId"),gtm:up(r)}})}a(Pc,"google");var ii=class{constructor(e,t=60*1e3,n=new ce){this.handler=e;this.timeout=t;this.timers=n}handle(e){return g(this,null,function*(){let t=yield Promise.race([this.handler.handle(e),this.timers.delay(this.timeout)]);return t||{type:bc,payload:new Error(`Request ${e.requestType} timed out after ${this.timeout}`),correlationId:e.correlationId}})}};a(ii,"TimeoutMessageHandler");var Tc=O(z());var Aa=class{static parse(e){if(!!e)return Aa.lookup.get(e.toLowerCase().trim())}},dr=Aa;a(dr,"UserConsentParser"),dr.lookup=["none","essential","functionality","performance","marketing","all"].reduce((e,t)=>e.set(t,t),new Map);var pr=class{static find(e){return It.scripts(new Ne(e.document)).map(n=>n.dataset.storageConsent).filter(Boolean).flatMap(n=>n.split(/\s*,\s*/g).map(i=>dr.parse(i))).filter(Boolean)}};a(pr,"UserConsentFinder");var dp=O(z());var qb=I("consent"),Sc=new Set(["all"]);function Ac(r){let e=new Set(r.filter(Boolean));return e.size===0||e.has("all")?Sc:(e.has("none")&&e.size!==1&&e.delete("none"),e)}a(Ac,"collapseConsentTypes");var ai=class{constructor(e){this.window=e}scrape(){return{userConsent:Array.from(Ac(pr.find(this.window)))}}};a(ai,"UserConsentScraper");function pp(r,e){return g(this,null,function*(){let t=se(r).triptease;I("integration-executor").log(`replaceExecutor old:${m(()=>t.integration.script.app().name)} new:${m(()=>e.script.app().name)}`),t.integration&&(yield t.integration.stop()),t.integration=e,yield e.start()})}a(pp,"replaceExecutor");var si=class{constructor(e,t,n=Rn(e),i=I("integration-executor"),s=se(e).onboard.messageBuilder,o=new ii(new ni(ec(e))),c=new Ln(o),l=jn(o),u=Et.create(e),v=new Wn(e,u),D=hc()){this.window=e;this.script=t;this.events=n;this.logger=i;this.messageBuilder=s;this.sender=o;this.kernel=c;this.kernelHost=l;this.history=u;this.processor=v;this.reporter=D;this.integrate=a(()=>g(this,null,function*(){this.logger.log("Begin integration executor");let e=yield this.reporter.timeAsync("page-scraping",()=>this.findPageData()),t=yield this.reporter.timeAsync("hotel-identification",()=>this.addIdentificationAndAdditionalData(e));t.language||(t.language=So(this.window));let n=this.processor.process(t);return this.logger.log("Processed integration data",n),this.lastPath!==this.window.location.pathname||!M.same(Oc(this.history.last()),Oc(n))?(this.logger.log("Integration data has changed - updating triptease.config"),this.window.triptease.config=n,this.history.add(n),yield this.sendToKernelHost(yield this.messageBuilder.buildMessage({type:"triptease.config",payload:n,context:{app:this.script.app()}})),this.lastPath=this.window.location.pathname):this.logger.log("No change in integration data - doing nothing"),n}),"integrate");pp(e,this)}start(){return g(this,null,function*(){this.logger.log(`IntegrationExecutor.start ${this.script.app().name}`),yield this.events.listen(this.integrate)})}stop(){return g(this,null,function*(){this.logger.log(`IntegrationExecutor.stop ${this.script.app().name}`),this.events.removeListener(this.integrate)})}addIdentificationAndAdditionalData(e){return g(this,null,function*(){let t=yield this.script.scrape(),n=yield new qn([new ai(this.window),new Kn(this.window),new ze(this.window),{scrape:()=>t},new Un(e)],this.logger).scrape();if(n.apiKey==="none")return this.logger.log('Skipping identification as apiKey is set to "none" - Only interested in page data for ARI feed'),e;if(n=T(h({},n),{type:mp(e.type,t.type),integrationName:this.script.integrationName().canonical}),this.logger.log("all identifiers",n),pa(e)&&Array.isArray(e.rateDetails)){e.rateDetails=yield this.processArrayIdentifiers(e.rateDetails,n);let s=this.getUniqueApiKey(e.rateDetails);s&&(n=T(h({},n),{apiKey:s}))}if(fa(e)&&Array.isArray(e.reservations)){e.reservations=yield this.processArrayIdentifiers(e.reservations,n);let s=this.getUniqueApiKey(e.reservations);s&&(n=T(h({},n),{apiKey:s}))}if(n.type===A.Group||n.disableDefaultHotelIdentification)this.logger.log("Disabling default hotel identification");else if(ur(n)||ur(e))this.logger.log("page data already contains identifiers (hotelName, hotelCode or apiKey) so skipping fallback identification");else{let s=new Qn(this.window).scrape();this.logger.log("hotel identifiers",s),n=h(h({},n),s)}let i=yield this.kernel.generateConfig(n);return this.logger.log("generatedConfig",i),y.removeEmpty(T(h(h(h({},n),e),i),{address:xc(yield n.address),disableDefaultHotelIdentification:void 0,identifiers:this.filterOutPossibleUserData(n)}))})}filterOutPossibleUserData(e){return m(()=>e.identifiers.filter(t=>cn.has(t.identifierType)))}getUniqueApiKey(e){let t=S.unique(e.map(n=>n.apiKey));if(t.length===1)return t[0]}processArrayIdentifiers(e,t){return g(this,null,function*(){return yield Promise.all(e.map(n=>g(this,null,function*(){return Pt(n)?h(h({},n),yield this.kernel.generateConfig(h(h({},t),Fn(n)))):n})))})}sendToKernelHost(e){return g(this,null,function*(){this.logger.log("Sending triptease.config message to local kernel host",e);let t=T(h({},e),{context:T(h({},e.context),{stats:this.reporter.summarise(),google:yield an(()=>Pc(this.window),{}),features:vo(this.window,...fp),performance:m(()=>PerformanceObserver.supportedEntryTypes,[])})});this.kernelHost.processConfig(t)})}findPageData(){return g(this,null,function*(){let e=[];for(let t of this.script.pages)try{let n=yield t.integrationData();if(n&&(n.pageClass=n.pageClass||uo(t)),Zo(n))return this.logger.log("Found valid page",n),n;e.push(n)}catch(n){this.logger.debug("Page didn't parse due to error",n)}return this.logger.log("No valid pages found - finding partial page from",e),Qo(e)||{type:A.Unknown}})}};a(si,"IntegrationExecutor");function Oc(r){if(!r)return{};let e=h({},r);return delete e.ratesModified,e}a(Oc,"exclude");var fp=["fetch","Set","Map","WebAssembly.constructor","PerformanceObserver","Date","Date.now","Date.prototype.toISOString","Date.prototype.toJSON","Date.prototype.getTime","crypto.randomUUID","crypto.getRandomValues","crypto.subtle.digest","Intl.Collator","Intl.NumberFormat","Intl.NumberFormat.prototype.formatToParts","Intl.DateTimeFormat","Intl.DateTimeFormat.prototype.formatToParts","console.log","navigator.share","navigator.serviceWorker","EventSource","customElements"];function mp(...r){return S.first([...r,A.Unknown].filter(Boolean).sort((0,Tc.by)(mo)))}a(mp,"calculatePageType");new si(window,new kn(window));})();
